
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Customer Churn Prediction with Amazon SageMaker Autopilot &#8212; 3.1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=30c166bc" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=30c166bc" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=e1ce3931"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script defer data-domain="feature-engine.readthedocs.io" src="https://plausible.io/js/plausible.js"></script>
    <script src="../../_static/js/copybutton.js?v=84772c1c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'example_notebooks/notebooks/sm-autopilot_customer_churn';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Unsupervised Learning Notebooks" href="../unsupervised.html" />
    <link rel="prev" title="Supervised Learning Notebooks" href="../supervised.html" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

    <!-- Cookie banner -->
    <style>
        /* Style for the cookie banner */
        #cookie-banner {
            position: fixed;
            bottom: 0;
            right: 0;
            background-color: #ffe4e1; /* Light Pink */
            color: #333;
            padding: 15px;
            max-width: 400px;
            display: none;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1000; /* Set a higher z-index value */
        }

        #cookie-banner p {
        font-size: 16px; /* Font size for the text */
        color: #333 !important; /* Set link color to black */
        line-height: 1.5; /* Increase line height for added spacing between sentences */
        }

        #cookie-banner a {
            color: #333;
            text-decoration: underline;
        }
    </style>

    <div id="cookie-banner">
        <h2 style="font-size: 20px; margin-bottom: 10px;">This site uses cookies</h2>
        <p style="font-size: 16px;">We use cookies to recognize your visits and preferences, to measure the effectiveness of the documentation, and discover how people find us. With your consent, you're helping us make our documentation better. <br><a href="https://www.trainindata.com/p/privacy" target="_blank">Learn More</a>.</p>
        <button id="cookie-accept">Accept</button>
        <button id="cookie-decline">Decline</button>
    </div>

    <script>
        // JavaScript to show the cookie banner and handle the accept button
        document.addEventListener('DOMContentLoaded', function () {
            var cookieBanner = document.getElementById('cookie-banner');
            var acceptButton = document.getElementById('cookie-accept');
            var declineButton = document.getElementById('cookie-decline');

            // Check if the user has already accepted or declined cookies
            var cookiesAccepted = localStorage.getItem('cookiesAccepted');

            if (!cookiesAccepted) {
                cookieBanner.style.display = 'block';

                acceptButton.addEventListener('click', function () {
                    localStorage.setItem('cookiesAccepted', 'true');
                    loadGoogleAnalytics();
                    cookieBanner.style.display = 'none';
                });

                declineButton.addEventListener('click', function () {
                    localStorage.setItem('cookiesAccepted', 'false');
                    cookieBanner.style.display = 'none';
                });
            } else if (cookiesAccepted === 'true') {
                loadGoogleAnalytics();
            }
        });

        function loadGoogleAnalytics() {
            // Load Google Analytics only if consent is given
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-Z6MPCG673G';
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-Z6MPCG673G');
        }
    </script>
    <!-- Cookie banner -->


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/sageops_logo.png" class="logo__image only-light" alt="3.1 - Home"/>
    <script>document.write(`<img src="../../_static/sageops_logo.png" class="logo__image only-dark" alt="3.1 - Home"/>`);</script>
  
  
</a></div>
    
      <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../quickstart/index.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide/index.html">
                        SageOps User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api_doc/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../about/index.html">
                        About
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../Support/index.html">
                        Support
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../quickstart/index.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide/index.html">
                        SageOps User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api_doc/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../about/index.html">
                        About
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../Support/index.html">
                        Support
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../supervised.html">Supervised Learning Notebooks</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Customer Churn Prediction with Amazon SageMaker Autopilot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../unsupervised.html">Unsupervised Learning Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deep_learning.html">Deep Learning Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_optimization.html">Model Optimization Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyspark.html">Pyspark Notebooks</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Example Notebooks</a></li>
    
    
    <li class="breadcrumb-item"><a href="../supervised.html" class="nav-link">Supervised Learning Notebooks</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Customer...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="Customer-Churn-Prediction-with-Amazon-SageMaker-Autopilot">
<h1>Customer Churn Prediction with Amazon SageMaker Autopilot<a class="headerlink" href="#Customer-Churn-Prediction-with-Amazon-SageMaker-Autopilot" title="Permalink to this heading">#</a></h1>
<p><strong>Using AutoPilot to Predict Mobile Customer Departure</strong> ## Check Buddha —</p>
<hr class="docutils" />
<p>Kernel <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">3</span> <span class="pre">(Data</span> <span class="pre">Science)</span></code> works well with this notebook.</p>
<section id="Contents">
<h2>Contents<a class="headerlink" href="#Contents" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#Introduction"><span class="std std-ref">Introduction</span></a></p></li>
<li><p><a class="reference internal" href="#Setup"><span class="std std-ref">Setup</span></a></p></li>
<li><p><a class="reference internal" href="#Data"><span class="std std-ref">Data</span></a></p></li>
<li><p>Train</p></li>
<li><p><a class="reference internal" href="#Results"><span class="std std-ref">Autopilot Results</span></a></p></li>
<li><p><a class="reference internal" href="#Host"><span class="std std-ref">Host</span></a></p></li>
<li><p><a class="reference internal" href="#Cleanup"><span class="std std-ref">Cleanup</span></a></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this heading">#</a></h2>
<p>Amazon SageMaker Autopilot is an automated machine learning (commonly referred to as AutoML) solution for tabular datasets. You can use SageMaker Autopilot in different ways: on autopilot (hence the name) or with human guidance, without code through SageMaker Studio, or using the AWS SDKs. This notebook, as a first glimpse, will use the AWS SDKs to simply create and deploy a machine learning model.</p>
<p>Losing customers is costly for any business. Identifying unhappy customers early on gives you a chance to offer them incentives to stay. This notebook describes using machine learning (ML) for the automated identification of unhappy customers, also known as customer churn prediction. ML models rarely give perfect predictions though, so this notebook is also about how to incorporate the relative costs of prediction mistakes when determining the financial outcome of using ML.</p>
<p>We use an example of churn that is familiar to all of us–leaving a mobile phone operator. Seems like I can always find fault with my provider du jour! And if my provider knows that I’m thinking of leaving, it can offer timely incentives–I can always use a phone upgrade or perhaps have a new feature activated–and I might just stick around. Incentives are often much more cost effective than losing and reacquiring a customer.</p>
</section>
<hr class="docutils" />
<section id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this heading">#</a></h2>
<p><em>This notebook was created and tested on an ml.m4.xlarge notebook instance.</em></p>
<p>Let’s start by specifying:</p>
<ul class="simple">
<li><p>The S3 bucket and prefix that you want to use for training and model data. This should be within the same region as the Notebook Instance, training, and hosting.</p></li>
<li><p>The IAM role arn used to give training and hosting access to your data. See the documentation for how to create these. Note, if more than one role is required for notebook instances, training, and/or hosting, please replace the boto regexp with a the appropriate full IAM role arn string(s).</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sagemaker</span>
<span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">from</span> <span class="nn">sagemaker</span> <span class="kn">import</span> <span class="n">get_execution_role</span>

<span class="n">region</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">region_name</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

<span class="c1"># You can modify the following to use a bucket of your choosing</span>
<span class="n">bucket</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">default_bucket</span><span class="p">()</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;sagemaker/DEMO-autopilot-churn&quot;</span>

<span class="n">role</span> <span class="o">=</span> <span class="n">get_execution_role</span><span class="p">()</span>

<span class="c1"># This is the client we will use to interact with SageMaker AutoPilot</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="n">service_name</span><span class="o">=</span><span class="s2">&quot;sagemaker&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, we’ll import the Python libraries we’ll need for the remainder of the exercise.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">strftime</span><span class="p">,</span> <span class="n">gmtime</span>
<span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">sagemaker</span>
<span class="kn">from</span> <span class="nn">sagemaker.predictor</span> <span class="kn">import</span> <span class="n">csv_serializer</span>
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="Data">
<h2>Data<a class="headerlink" href="#Data" title="Permalink to this heading">#</a></h2>
<p>Mobile operators have historical records on which customers ultimately ended up churning and which continued using the service. We can use this historical information to construct an ML model of one mobile operator’s churn using a process called training. After training the model, we can pass the profile information of an arbitrary customer (the same profile information that we used to train the model) to the model, and have the model predict whether this customer is going to churn. Of course,
we expect the model to make mistakes–after all, predicting the future is tricky business! But I’ll also show how to deal with prediction errors.</p>
<p>The dataset we will use is synthetically generated, but indictive of the types of features you’d see in this use case.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
<span class="n">s3</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;sagemaker-example-files-prod-</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;datasets/tabular/synthetic/churn.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;churn.txt&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Upload-the-dataset-to-S3">
<h3>Upload the dataset to S3<a class="headerlink" href="#Upload-the-dataset-to-S3" title="Permalink to this heading">#</a></h3>
<p>Before you run Autopilot on the dataset, first perform a check of the dataset to make sure that it has no obvious errors. The Autopilot process can take long time, and it’s generally a good practice to inspect the dataset before you start a job. This particular dataset is small, so you can inspect it in the notebook instance itself. If you have a larger dataset that will not fit in a notebook instance memory, inspect the dataset offline using a big data analytics tool like Apache Spark.
<a class="reference external" href="https://github.com/awslabs/deequ">Deequ</a> is a library built on top of Apache Spark that can be helpful for performing checks on large datasets. Autopilot is capable of handling datasets up to 5 GB.</p>
<p>Read the data into a Pandas data frame and take a look.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">churn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./churn.txt&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">churn</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Account Length</th>
      <th>Area Code</th>
      <th>Phone</th>
      <th>Int'l Plan</th>
      <th>VMail Plan</th>
      <th>VMail Message</th>
      <th>Day Mins</th>
      <th>Day Calls</th>
      <th>Day Charge</th>
      <th>Eve Mins</th>
      <th>Eve Calls</th>
      <th>Eve Charge</th>
      <th>Night Mins</th>
      <th>Night Calls</th>
      <th>Night Charge</th>
      <th>Intl Mins</th>
      <th>Intl Calls</th>
      <th>Intl Charge</th>
      <th>CustServ Calls</th>
      <th>Churn?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>KS</td>
      <td>128</td>
      <td>415</td>
      <td>382-4657</td>
      <td>no</td>
      <td>yes</td>
      <td>25</td>
      <td>265.1</td>
      <td>110</td>
      <td>45.07</td>
      <td>197.4</td>
      <td>99</td>
      <td>16.78</td>
      <td>244.7</td>
      <td>91</td>
      <td>11.01</td>
      <td>10.0</td>
      <td>3</td>
      <td>2.70</td>
      <td>1</td>
      <td>False.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>OH</td>
      <td>107</td>
      <td>415</td>
      <td>371-7191</td>
      <td>no</td>
      <td>yes</td>
      <td>26</td>
      <td>161.6</td>
      <td>123</td>
      <td>27.47</td>
      <td>195.5</td>
      <td>103</td>
      <td>16.62</td>
      <td>254.4</td>
      <td>103</td>
      <td>11.45</td>
      <td>13.7</td>
      <td>3</td>
      <td>3.70</td>
      <td>1</td>
      <td>False.</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NJ</td>
      <td>137</td>
      <td>415</td>
      <td>358-1921</td>
      <td>no</td>
      <td>no</td>
      <td>0</td>
      <td>243.4</td>
      <td>114</td>
      <td>41.38</td>
      <td>121.2</td>
      <td>110</td>
      <td>10.30</td>
      <td>162.6</td>
      <td>104</td>
      <td>7.32</td>
      <td>12.2</td>
      <td>5</td>
      <td>3.29</td>
      <td>0</td>
      <td>False.</td>
    </tr>
    <tr>
      <th>3</th>
      <td>OH</td>
      <td>84</td>
      <td>408</td>
      <td>375-9999</td>
      <td>yes</td>
      <td>no</td>
      <td>0</td>
      <td>299.4</td>
      <td>71</td>
      <td>50.90</td>
      <td>61.9</td>
      <td>88</td>
      <td>5.26</td>
      <td>196.9</td>
      <td>89</td>
      <td>8.86</td>
      <td>6.6</td>
      <td>7</td>
      <td>1.78</td>
      <td>2</td>
      <td>False.</td>
    </tr>
    <tr>
      <th>4</th>
      <td>OK</td>
      <td>75</td>
      <td>415</td>
      <td>330-6626</td>
      <td>yes</td>
      <td>no</td>
      <td>0</td>
      <td>166.7</td>
      <td>113</td>
      <td>28.34</td>
      <td>148.3</td>
      <td>122</td>
      <td>12.61</td>
      <td>186.9</td>
      <td>121</td>
      <td>8.41</td>
      <td>10.1</td>
      <td>3</td>
      <td>2.73</td>
      <td>3</td>
      <td>False.</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3328</th>
      <td>AZ</td>
      <td>192</td>
      <td>415</td>
      <td>414-4276</td>
      <td>no</td>
      <td>yes</td>
      <td>36</td>
      <td>156.2</td>
      <td>77</td>
      <td>26.55</td>
      <td>215.5</td>
      <td>126</td>
      <td>18.32</td>
      <td>279.1</td>
      <td>83</td>
      <td>12.56</td>
      <td>9.9</td>
      <td>6</td>
      <td>2.67</td>
      <td>2</td>
      <td>False.</td>
    </tr>
    <tr>
      <th>3329</th>
      <td>WV</td>
      <td>68</td>
      <td>415</td>
      <td>370-3271</td>
      <td>no</td>
      <td>no</td>
      <td>0</td>
      <td>231.1</td>
      <td>57</td>
      <td>39.29</td>
      <td>153.4</td>
      <td>55</td>
      <td>13.04</td>
      <td>191.3</td>
      <td>123</td>
      <td>8.61</td>
      <td>9.6</td>
      <td>4</td>
      <td>2.59</td>
      <td>3</td>
      <td>False.</td>
    </tr>
    <tr>
      <th>3330</th>
      <td>RI</td>
      <td>28</td>
      <td>510</td>
      <td>328-8230</td>
      <td>no</td>
      <td>no</td>
      <td>0</td>
      <td>180.8</td>
      <td>109</td>
      <td>30.74</td>
      <td>288.8</td>
      <td>58</td>
      <td>24.55</td>
      <td>191.9</td>
      <td>91</td>
      <td>8.64</td>
      <td>14.1</td>
      <td>6</td>
      <td>3.81</td>
      <td>2</td>
      <td>False.</td>
    </tr>
    <tr>
      <th>3331</th>
      <td>CT</td>
      <td>184</td>
      <td>510</td>
      <td>364-6381</td>
      <td>yes</td>
      <td>no</td>
      <td>0</td>
      <td>213.8</td>
      <td>105</td>
      <td>36.35</td>
      <td>159.6</td>
      <td>84</td>
      <td>13.57</td>
      <td>139.2</td>
      <td>137</td>
      <td>6.26</td>
      <td>5.0</td>
      <td>10</td>
      <td>1.35</td>
      <td>2</td>
      <td>False.</td>
    </tr>
    <tr>
      <th>3332</th>
      <td>TN</td>
      <td>74</td>
      <td>415</td>
      <td>400-4344</td>
      <td>no</td>
      <td>yes</td>
      <td>25</td>
      <td>234.4</td>
      <td>113</td>
      <td>39.85</td>
      <td>265.9</td>
      <td>82</td>
      <td>22.60</td>
      <td>241.4</td>
      <td>77</td>
      <td>10.86</td>
      <td>13.7</td>
      <td>4</td>
      <td>3.70</td>
      <td>0</td>
      <td>False.</td>
    </tr>
  </tbody>
</table>
<p>3333 rows × 21 columns</p>
</div></div>
</div>
<p>By modern standards, it’s a relatively small dataset, with only 5,000 records, where each record uses 21 attributes to describe the profile of a customer of an unknown US mobile operator. The attributes are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">State</span></code>: the US state in which the customer resides, indicated by a two-letter abbreviation; for example, OH or NJ</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Account</span> <span class="pre">Length</span></code>: the number of days that this account has been active</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Area</span> <span class="pre">Code</span></code>: the three-digit area code of the corresponding customer’s phone number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Phone</span></code>: the remaining seven-digit phone number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Int’l</span> <span class="pre">Plan</span></code>: whether the customer has an international calling plan: yes/no</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VMail</span> <span class="pre">Plan</span></code>: whether the customer has a voice mail feature: yes/no</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VMail</span> <span class="pre">Message</span></code>: presumably the average number of voice mail messages per month</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Day</span> <span class="pre">Mins</span></code>: the total number of calling minutes used during the day</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Day</span> <span class="pre">Calls</span></code>: the total number of calls placed during the day</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Day</span> <span class="pre">Charge</span></code>: the billed cost of daytime calls</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Eve</span> <span class="pre">Mins,</span> <span class="pre">Eve</span> <span class="pre">Calls,</span> <span class="pre">Eve</span> <span class="pre">Charge</span></code>: the billed cost for calls placed during the evening</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Night</span> <span class="pre">Mins</span></code>, <code class="docutils literal notranslate"><span class="pre">Night</span> <span class="pre">Calls</span></code>, <code class="docutils literal notranslate"><span class="pre">Night</span> <span class="pre">Charge</span></code>: the billed cost for calls placed during nighttime</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Intl</span> <span class="pre">Mins</span></code>, <code class="docutils literal notranslate"><span class="pre">Intl</span> <span class="pre">Calls</span></code>, <code class="docutils literal notranslate"><span class="pre">Intl</span> <span class="pre">Charge</span></code>: the billed cost for international calls</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CustServ</span> <span class="pre">Calls</span></code>: the number of calls placed to Customer Service</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Churn?</span></code>: whether the customer left the service: true/false</p></li>
</ul>
<p>The last attribute, <code class="docutils literal notranslate"><span class="pre">Churn?</span></code>, is known as the target attribute–the attribute that we want the ML model to predict.</p>
</section>
<section id="Reserve-some-data-for-calling-inference-on-the-model">
<h3>Reserve some data for calling inference on the model<a class="headerlink" href="#Reserve-some-data-for-calling-inference-on-the-model" title="Permalink to this heading">#</a></h3>
<p>Divide the data into training and testing splits. The training split is used by SageMaker Autopilot. The testing split is reserved to perform inference using the suggested model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="n">churn</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="n">churn</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">test_data_no_target</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Churn?&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Now we’ll upload these files to S3.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_file</span> <span class="o">=</span> <span class="s2">&quot;train_data.csv&quot;</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">train_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train_data_s3_path</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">upload_data</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">train_file</span><span class="p">,</span> <span class="n">key_prefix</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;/train&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train data uploaded to: &quot;</span> <span class="o">+</span> <span class="n">train_data_s3_path</span><span class="p">)</span>

<span class="n">test_file</span> <span class="o">=</span> <span class="s2">&quot;test_data.csv&quot;</span>
<span class="n">test_data_no_target</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_data_s3_path</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">upload_data</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">test_file</span><span class="p">,</span> <span class="n">key_prefix</span><span class="o">=</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;/test&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test data uploaded to: &quot;</span> <span class="o">+</span> <span class="n">test_data_s3_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Train data uploaded to: s3://sagemaker-us-west-2-262002448484/sagemaker/DEMO-autopilot-churn/train/train_data.csv
Test data uploaded to: s3://sagemaker-us-west-2-262002448484/sagemaker/DEMO-autopilot-churn/test/test_data.csv
</pre></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="Setting-up-the-SageMaker-Autopilot-Job">
<h2>Setting up the SageMaker Autopilot Job<a class="headerlink" href="#Setting-up-the-SageMaker-Autopilot-Job" title="Permalink to this heading">#</a></h2>
<p>After uploading the dataset to Amazon S3, you can invoke Autopilot to find the best ML pipeline to train a model on this dataset.</p>
<p>The required inputs for invoking a Autopilot job are: * Amazon S3 location for input dataset and for all output artifacts * Name of the column of the dataset you want to predict (<code class="docutils literal notranslate"><span class="pre">Churn?</span></code> in this case) * An IAM role</p>
<p>Currently Autopilot supports only tabular datasets in CSV format. Either all files should have a header row, or the first file of the dataset, when sorted in alphabetical/lexical order by name, is expected to have a header row.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_data_config</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;DataSource&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;S3DataSource&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;S3DataType&quot;</span><span class="p">:</span> <span class="s2">&quot;S3Prefix&quot;</span><span class="p">,</span>
                <span class="s2">&quot;S3Uri&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">/train&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span> <span class="n">prefix</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;TargetAttributeName&quot;</span><span class="p">:</span> <span class="s2">&quot;Churn?&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="n">output_data_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;S3OutputPath&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">/output&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)}</span>
</pre></div>
</div>
</div>
<p>You can also specify the type of problem you want to solve with your dataset (<code class="docutils literal notranslate"><span class="pre">Regression,</span> <span class="pre">MulticlassClassification,</span> <span class="pre">BinaryClassification</span></code>). In case you are not sure, SageMaker Autopilot will infer the problem type based on statistics of the target column (the column you want to predict).</p>
<p>Because the target attribute, <code class="docutils literal notranslate"><span class="pre">Churn?</span></code>, is binary, our model will be performing binary prediction, also known as binary classification. In this example we will let AutoPilot infer the type of problem for us.</p>
<p>You have the option to limit the running time of a SageMaker Autopilot job by providing either the maximum number of pipeline evaluations or candidates (one pipeline evaluation is called a <code class="docutils literal notranslate"><span class="pre">Candidate</span></code> because it generates a candidate model) or providing the total time allocated for the overall Autopilot job. Under default settings, this job takes about four hours to run. This varies between runs because of the nature of the exploratory process Autopilot uses to find optimal training
parameters.</p>
<section id="Launching-the-SageMaker-Autopilot-Job">
<h3>Launching the SageMaker Autopilot Job<a class="headerlink" href="#Launching-the-SageMaker-Autopilot-Job" title="Permalink to this heading">#</a></h3>
<p>You can now launch the Autopilot job by calling the <code class="docutils literal notranslate"><span class="pre">create_auto_ml_job</span></code> API. We limit the number of candidates to 20 so that the job finishes in a few minutes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">gmtime</span><span class="p">,</span> <span class="n">strftime</span><span class="p">,</span> <span class="n">sleep</span>

<span class="n">timestamp_suffix</span> <span class="o">=</span> <span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%H-%M-%S&quot;</span><span class="p">,</span> <span class="n">gmtime</span><span class="p">())</span>

<span class="n">auto_ml_job_name</span> <span class="o">=</span> <span class="s2">&quot;automl-churn-&quot;</span> <span class="o">+</span> <span class="n">timestamp_suffix</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AutoMLJobName: &quot;</span> <span class="o">+</span> <span class="n">auto_ml_job_name</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">create_auto_ml_job</span><span class="p">(</span>
    <span class="n">AutoMLJobName</span><span class="o">=</span><span class="n">auto_ml_job_name</span><span class="p">,</span>
    <span class="n">InputDataConfig</span><span class="o">=</span><span class="n">input_data_config</span><span class="p">,</span>
    <span class="n">OutputDataConfig</span><span class="o">=</span><span class="n">output_data_config</span><span class="p">,</span>
    <span class="n">AutoMLJobConfig</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;CompletionCriteria&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;MaxCandidates&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}},</span>
    <span class="n">RoleArn</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AutoMLJobName: automl-churn-03-17-50-14
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;AutoMLJobArn&#39;: &#39;arn:aws:sagemaker:us-west-2:262002448484:automl-job/automl-churn-03-17-50-14&#39;,
 &#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;346f751d-4738-4c0f-86a4-513f15e2b2ea&#39;,
  &#39;HTTPStatusCode&#39;: 200,
  &#39;HTTPHeaders&#39;: {&#39;x-amzn-requestid&#39;: &#39;346f751d-4738-4c0f-86a4-513f15e2b2ea&#39;,
   &#39;content-type&#39;: &#39;application/x-amz-json-1.1&#39;,
   &#39;content-length&#39;: &#39;95&#39;,
   &#39;date&#39;: &#39;Wed, 03 Feb 2021 17:50:14 GMT&#39;},
  &#39;RetryAttempts&#39;: 0}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Store the AutoMLJobName name for use in subsequent notebooks</span>
<span class="o">%</span><span class="k">store</span> auto_ml_job_name
<span class="n">auto_ml_job_name</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Stored &#39;auto_ml_job_name&#39; (str)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;automl-churn-03-17-50-14&#39;
</pre></div></div>
</div>
</section>
<section id="Tracking-SageMaker-Autopilot-job-progress">
<h3>Tracking SageMaker Autopilot job progress<a class="headerlink" href="#Tracking-SageMaker-Autopilot-job-progress" title="Permalink to this heading">#</a></h3>
<p>SageMaker Autopilot job consists of the following high-level steps : * Analyzing Data, where the dataset is analyzed and Autopilot comes up with a list of ML pipelines that should be tried out on the dataset. The dataset is also split into train and validation sets. * Feature Engineering, where Autopilot performs feature transformation on individual features of the dataset as well as at an aggregate level. * Model Tuning, where the top performing pipeline is selected along with the optimal
hyperparameters for the training algorithm (the last stage of the pipeline).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;JobStatus - Secondary Status&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------&quot;</span><span class="p">)</span>


<span class="n">describe_response</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">describe_auto_ml_job</span><span class="p">(</span><span class="n">AutoMLJobName</span><span class="o">=</span><span class="n">auto_ml_job_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">describe_response</span><span class="p">[</span><span class="s2">&quot;AutoMLJobStatus&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="n">describe_response</span><span class="p">[</span><span class="s2">&quot;AutoMLJobSecondaryStatus&quot;</span><span class="p">])</span>
<span class="n">job_run_status</span> <span class="o">=</span> <span class="n">describe_response</span><span class="p">[</span><span class="s2">&quot;AutoMLJobStatus&quot;</span><span class="p">]</span>

<span class="k">while</span> <span class="n">job_run_status</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Failed&quot;</span><span class="p">,</span> <span class="s2">&quot;Completed&quot;</span><span class="p">,</span> <span class="s2">&quot;Stopped&quot;</span><span class="p">):</span>
    <span class="n">describe_response</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">describe_auto_ml_job</span><span class="p">(</span><span class="n">AutoMLJobName</span><span class="o">=</span><span class="n">auto_ml_job_name</span><span class="p">)</span>
    <span class="n">job_run_status</span> <span class="o">=</span> <span class="n">describe_response</span><span class="p">[</span><span class="s2">&quot;AutoMLJobStatus&quot;</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="n">describe_response</span><span class="p">[</span><span class="s2">&quot;AutoMLJobStatus&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="n">describe_response</span><span class="p">[</span><span class="s2">&quot;AutoMLJobSecondaryStatus&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
JobStatus - Secondary Status
------------------------------
InProgress - Starting
InProgress - Starting
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - AnalyzingData
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - FeatureEngineering
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
InProgress - ModelTuning
Completed - MaxCandidatesReached
</pre></div></div>
</div>
<p><strong>AutoPilot automatically generates two executable Jupyter Notebooks: - SageMakerAutopilotDataExplorationNotebook.ipynb and - SageMakerAutopilotCandidateDefinitionNotebook.ipynb. These notebooks are stored in S3. Let us download them onto our SageMaker Notebook instance so we could explore them later.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print(describe_response)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">describe_response</span><span class="p">[</span><span class="s2">&quot;AutoMLJobArtifacts&quot;</span><span class="p">][</span><span class="s2">&quot;CandidateDefinitionNotebookLocation&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">describe_response</span><span class="p">[</span><span class="s2">&quot;AutoMLJobArtifacts&quot;</span><span class="p">][</span><span class="s2">&quot;DataExplorationNotebookLocation&quot;</span><span class="p">])</span>

<span class="n">candidate_nbk</span> <span class="o">=</span> <span class="n">describe_response</span><span class="p">[</span><span class="s2">&quot;AutoMLJobArtifacts&quot;</span><span class="p">][</span><span class="s2">&quot;CandidateDefinitionNotebookLocation&quot;</span><span class="p">]</span>
<span class="n">data_explore_nbk</span> <span class="o">=</span> <span class="n">describe_response</span><span class="p">[</span><span class="s2">&quot;AutoMLJobArtifacts&quot;</span><span class="p">][</span><span class="s2">&quot;DataExplorationNotebookLocation&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
s3://sagemaker-us-west-2-262002448484/sagemaker/DEMO-autopilot-churn/output/automl-churn-03-17-50-14/sagemaker-automl-candidates/pr-1-087be24846d8436faecf8de3c2d70c10cd7e5218bb62499f822657956b/notebooks/SageMakerAutopilotCandidateDefinitionNotebook.ipynb
s3://sagemaker-us-west-2-262002448484/sagemaker/DEMO-autopilot-churn/output/automl-churn-03-17-50-14/sagemaker-automl-candidates/pr-1-087be24846d8436faecf8de3c2d70c10cd7e5218bb62499f822657956b/notebooks/SageMakerAutopilotDataExplorationNotebook.ipynb
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">split_s3_path</span><span class="p">(</span><span class="n">s3_path</span><span class="p">):</span>
    <span class="n">path_parts</span> <span class="o">=</span> <span class="n">s3_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;s3://&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="n">bucket</span> <span class="o">=</span> <span class="n">path_parts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_parts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bucket</span><span class="p">,</span> <span class="n">key</span>


<span class="n">s3_bucket</span><span class="p">,</span> <span class="n">candidate_nbk_key</span> <span class="o">=</span> <span class="n">split_s3_path</span><span class="p">(</span><span class="n">candidate_nbk</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">data_explore_nbk_key</span> <span class="o">=</span> <span class="n">split_s3_path</span><span class="p">(</span><span class="n">data_explore_nbk</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">candidate_nbk_key</span><span class="p">,</span> <span class="n">data_explore_nbk_key</span><span class="p">)</span>

<span class="n">session</span><span class="o">.</span><span class="n">download_data</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;./&quot;</span><span class="p">,</span> <span class="n">bucket</span><span class="o">=</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">key_prefix</span><span class="o">=</span><span class="n">candidate_nbk_key</span><span class="p">)</span>

<span class="n">session</span><span class="o">.</span><span class="n">download_data</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;./&quot;</span><span class="p">,</span> <span class="n">bucket</span><span class="o">=</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">key_prefix</span><span class="o">=</span><span class="n">data_explore_nbk_key</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
sagemaker-us-west-2-262002448484 sagemaker/DEMO-autopilot-churn/output/automl-churn-03-17-50-14/sagemaker-automl-candidates/pr-1-087be24846d8436faecf8de3c2d70c10cd7e5218bb62499f822657956b/notebooks/SageMakerAutopilotCandidateDefinitionNotebook.ipynb sagemaker/DEMO-autopilot-churn/output/automl-churn-03-17-50-14/sagemaker-automl-candidates/pr-1-087be24846d8436faecf8de3c2d70c10cd7e5218bb62499f822657956b/notebooks/SageMakerAutopilotDataExplorationNotebook.ipynb
</pre></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="Results">
<h2>Results<a class="headerlink" href="#Results" title="Permalink to this heading">#</a></h2>
<p>Now use the describe_auto_ml_job API to look up the best candidate selected by the SageMaker Autopilot job.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_candidate</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">describe_auto_ml_job</span><span class="p">(</span><span class="n">AutoMLJobName</span><span class="o">=</span><span class="n">auto_ml_job_name</span><span class="p">)[</span><span class="s2">&quot;BestCandidate&quot;</span><span class="p">]</span>
<span class="n">best_candidate_name</span> <span class="o">=</span> <span class="n">best_candidate</span><span class="p">[</span><span class="s2">&quot;CandidateName&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_candidate</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CandidateName: &quot;</span> <span class="o">+</span> <span class="n">best_candidate_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;FinalAutoMLJobObjectiveMetricName: &quot;</span>
    <span class="o">+</span> <span class="n">best_candidate</span><span class="p">[</span><span class="s2">&quot;FinalAutoMLJobObjectiveMetric&quot;</span><span class="p">][</span><span class="s2">&quot;MetricName&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;FinalAutoMLJobObjectiveMetricValue: &quot;</span>
    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">best_candidate</span><span class="p">[</span><span class="s2">&quot;FinalAutoMLJobObjectiveMetric&quot;</span><span class="p">][</span><span class="s2">&quot;Value&quot;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;CandidateName&#39;: &#39;tuning-job-1-3572d1c0effe4c2db9-017-ab2e9b77&#39;, &#39;FinalAutoMLJobObjectiveMetric&#39;: {&#39;MetricName&#39;: &#39;validation:f1&#39;, &#39;Value&#39;: 0.923229992389679}, &#39;ObjectiveStatus&#39;: &#39;Succeeded&#39;, &#39;CandidateSteps&#39;: [{&#39;CandidateStepType&#39;: &#39;AWS::SageMaker::ProcessingJob&#39;, &#39;CandidateStepArn&#39;: &#39;arn:aws:sagemaker:us-west-2:262002448484:processing-job/db-1-dc376427266845c88039d2bdb3410fdf23ec309a025e4f1eb84b5eb853&#39;, &#39;CandidateStepName&#39;: &#39;db-1-dc376427266845c88039d2bdb3410fdf23ec309a025e4f1eb84b5eb853&#39;}, {&#39;CandidateStepType&#39;: &#39;AWS::SageMaker::TrainingJob&#39;, &#39;CandidateStepArn&#39;: &#39;arn:aws:sagemaker:us-west-2:262002448484:training-job/automl-chu-dpp5-1-705bf26de0f842c3b3cd5e0e57f12bce7834aa5c88b04&#39;, &#39;CandidateStepName&#39;: &#39;automl-chu-dpp5-1-705bf26de0f842c3b3cd5e0e57f12bce7834aa5c88b04&#39;}, {&#39;CandidateStepType&#39;: &#39;AWS::SageMaker::TransformJob&#39;, &#39;CandidateStepArn&#39;: &#39;arn:aws:sagemaker:us-west-2:262002448484:transform-job/automl-chu-dpp5-rpb-1-61fcb42b552d4a4b8ab2655f68ff1f4e8048ada21&#39;, &#39;CandidateStepName&#39;: &#39;automl-chu-dpp5-rpb-1-61fcb42b552d4a4b8ab2655f68ff1f4e8048ada21&#39;}, {&#39;CandidateStepType&#39;: &#39;AWS::SageMaker::TrainingJob&#39;, &#39;CandidateStepArn&#39;: &#39;arn:aws:sagemaker:us-west-2:262002448484:training-job/tuning-job-1-3572d1c0effe4c2db9-017-ab2e9b77&#39;, &#39;CandidateStepName&#39;: &#39;tuning-job-1-3572d1c0effe4c2db9-017-ab2e9b77&#39;}], &#39;CandidateStatus&#39;: &#39;Completed&#39;, &#39;InferenceContainers&#39;: [{&#39;Image&#39;: &#39;246618743249.dkr.ecr.us-west-2.amazonaws.com/sagemaker-sklearn-automl:0.2-1-cpu-py3&#39;, &#39;ModelDataUrl&#39;: &#39;s3://sagemaker-us-west-2-262002448484/sagemaker/DEMO-autopilot-churn/output/automl-churn-03-17-50-14/data-processor-models/automl-chu-dpp5-1-705bf26de0f842c3b3cd5e0e57f12bce7834aa5c88b04/output/model.tar.gz&#39;, &#39;Environment&#39;: {&#39;AUTOML_SPARSE_ENCODE_RECORDIO_PROTOBUF&#39;: &#39;1&#39;, &#39;AUTOML_TRANSFORM_MODE&#39;: &#39;feature-transform&#39;, &#39;SAGEMAKER_DEFAULT_INVOCATIONS_ACCEPT&#39;: &#39;application/x-recordio-protobuf&#39;, &#39;SAGEMAKER_PROGRAM&#39;: &#39;sagemaker_serve&#39;, &#39;SAGEMAKER_SUBMIT_DIRECTORY&#39;: &#39;/opt/ml/model/code&#39;}}, {&#39;Image&#39;: &#39;246618743249.dkr.ecr.us-west-2.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3&#39;, &#39;ModelDataUrl&#39;: &#39;s3://sagemaker-us-west-2-262002448484/sagemaker/DEMO-autopilot-churn/output/automl-churn-03-17-50-14/tuning/automl-chu-dpp5-xgb/tuning-job-1-3572d1c0effe4c2db9-017-ab2e9b77/output/model.tar.gz&#39;, &#39;Environment&#39;: {&#39;MAX_CONTENT_LENGTH&#39;: &#39;20971520&#39;, &#39;SAGEMAKER_DEFAULT_INVOCATIONS_ACCEPT&#39;: &#39;text/csv&#39;, &#39;SAGEMAKER_INFERENCE_OUTPUT&#39;: &#39;predicted_label&#39;, &#39;SAGEMAKER_INFERENCE_SUPPORTED&#39;: &#39;predicted_label,probability,probabilities&#39;}}, {&#39;Image&#39;: &#39;246618743249.dkr.ecr.us-west-2.amazonaws.com/sagemaker-sklearn-automl:0.2-1-cpu-py3&#39;, &#39;ModelDataUrl&#39;: &#39;s3://sagemaker-us-west-2-262002448484/sagemaker/DEMO-autopilot-churn/output/automl-churn-03-17-50-14/data-processor-models/automl-chu-dpp5-1-705bf26de0f842c3b3cd5e0e57f12bce7834aa5c88b04/output/model.tar.gz&#39;, &#39;Environment&#39;: {&#39;AUTOML_TRANSFORM_MODE&#39;: &#39;inverse-label-transform&#39;, &#39;SAGEMAKER_DEFAULT_INVOCATIONS_ACCEPT&#39;: &#39;text/csv&#39;, &#39;SAGEMAKER_INFERENCE_INPUT&#39;: &#39;predicted_label&#39;, &#39;SAGEMAKER_INFERENCE_OUTPUT&#39;: &#39;predicted_label&#39;, &#39;SAGEMAKER_INFERENCE_SUPPORTED&#39;: &#39;predicted_label,probability,labels,probabilities&#39;, &#39;SAGEMAKER_PROGRAM&#39;: &#39;sagemaker_serve&#39;, &#39;SAGEMAKER_SUBMIT_DIRECTORY&#39;: &#39;/opt/ml/model/code&#39;}}], &#39;CreationTime&#39;: datetime.datetime(2021, 2, 3, 18, 12, 19, tzinfo=tzlocal()), &#39;EndTime&#39;: datetime.datetime(2021, 2, 3, 18, 13, 2, tzinfo=tzlocal()), &#39;LastModifiedTime&#39;: datetime.datetime(2021, 2, 3, 18, 15, 52, 159000, tzinfo=tzlocal())}


CandidateName: tuning-job-1-3572d1c0effe4c2db9-017-ab2e9b77
FinalAutoMLJobObjectiveMetricName: validation:f1
FinalAutoMLJobObjectiveMetricValue: 0.923229992389679
</pre></div></div>
</div>
<p>Due to some randomness in the algorithms involved, different runs will provide slightly different results, but accuracy will be around or above <span class="math notranslate nohighlight">\(93\%\)</span>, which is a good result.</p>
<p><strong>If you are curious to explore the performance of other algorithms that AutoPilot explored, they are enumerated for you below via list_candidates_for_auto_ml_job() API call</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sm.describe_auto_ml_job(AutoMLJobName=auto_ml_job_name)</span>
<span class="c1"># sm.list_auto_ml_jobs()</span>
<span class="n">sm_dict</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">list_candidates_for_auto_ml_job</span><span class="p">(</span><span class="n">AutoMLJobName</span><span class="o">=</span><span class="n">auto_ml_job_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[109]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sm_dict</span><span class="p">[</span><span class="s2">&quot;Candidates&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;CandidateName&quot;</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;FinalAutoMLJobObjectiveMetric&quot;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;InferenceContainers&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;Image&quot;</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tuning-job-1-3572d1c0effe4c2db9-020-e82606f5 {&#39;MetricName&#39;: &#39;validation:binary_f_beta&#39;, &#39;Value&#39;: 0.35087719559669495}
174872318107.dkr.ecr.us-west-2.amazonaws.com/linear-learner:latest

tuning-job-1-3572d1c0effe4c2db9-019-343c7bdb {&#39;MetricName&#39;: &#39;validation:f1&#39;, &#39;Value&#39;: 0.752780020236969}
246618743249.dkr.ecr.us-west-2.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3

tuning-job-1-3572d1c0effe4c2db9-018-7eb3911a {&#39;MetricName&#39;: &#39;validation:f1&#39;, &#39;Value&#39;: 0.923229992389679}
246618743249.dkr.ecr.us-west-2.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3

tuning-job-1-3572d1c0effe4c2db9-017-ab2e9b77 {&#39;MetricName&#39;: &#39;validation:f1&#39;, &#39;Value&#39;: 0.923229992389679}
246618743249.dkr.ecr.us-west-2.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3

tuning-job-1-3572d1c0effe4c2db9-016-5aa287c4 {&#39;MetricName&#39;: &#39;validation:binary_f_beta&#39;, &#39;Value&#39;: 0.23999999463558197}
174872318107.dkr.ecr.us-west-2.amazonaws.com/linear-learner:latest

tuning-job-1-3572d1c0effe4c2db9-015-56ca82e5 {&#39;MetricName&#39;: &#39;validation:binary_f_beta&#39;, &#39;Value&#39;: 0.23999999463558197}
174872318107.dkr.ecr.us-west-2.amazonaws.com/linear-learner:latest

tuning-job-1-3572d1c0effe4c2db9-014-e9ec7e8c {&#39;MetricName&#39;: &#39;validation:f1&#39;, &#39;Value&#39;: 0.8602499961853027}
246618743249.dkr.ecr.us-west-2.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3

tuning-job-1-3572d1c0effe4c2db9-013-b86fdc91 {&#39;MetricName&#39;: &#39;validation:f1&#39;, &#39;Value&#39;: 0.8618000149726868}
246618743249.dkr.ecr.us-west-2.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3

tuning-job-1-3572d1c0effe4c2db9-012-c8883e70 {&#39;MetricName&#39;: &#39;validation:f1&#39;, &#39;Value&#39;: 0.7779200077056885}
246618743249.dkr.ecr.us-west-2.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3

tuning-job-1-3572d1c0effe4c2db9-011-c4159396 {&#39;MetricName&#39;: &#39;validation:binary_f_beta&#39;, &#39;Value&#39;: 0.47926267981529236}
174872318107.dkr.ecr.us-west-2.amazonaws.com/linear-learner:latest

</pre></div></div>
</div>
</section>
<hr class="docutils" />
<section id="Host">
<h2>Host<a class="headerlink" href="#Host" title="Permalink to this heading">#</a></h2>
<p>Now that we’ve trained the algorithm, let’s create a model and deploy it to a hosted endpoint.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timestamp_suffix</span> <span class="o">=</span> <span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%H-%M-%S&quot;</span><span class="p">,</span> <span class="n">gmtime</span><span class="p">())</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="n">best_candidate_name</span> <span class="o">+</span> <span class="n">timestamp_suffix</span> <span class="o">+</span> <span class="s2">&quot;-model&quot;</span>
<span class="n">model_arn</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span>
    <span class="n">Containers</span><span class="o">=</span><span class="n">best_candidate</span><span class="p">[</span><span class="s2">&quot;InferenceContainers&quot;</span><span class="p">],</span> <span class="n">ModelName</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span> <span class="n">ExecutionRoleArn</span><span class="o">=</span><span class="n">role</span>
<span class="p">)</span>

<span class="n">epc_name</span> <span class="o">=</span> <span class="n">best_candidate_name</span> <span class="o">+</span> <span class="n">timestamp_suffix</span> <span class="o">+</span> <span class="s2">&quot;-epc&quot;</span>
<span class="n">ep_config</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">create_endpoint_config</span><span class="p">(</span>
    <span class="n">EndpointConfigName</span><span class="o">=</span><span class="n">epc_name</span><span class="p">,</span>
    <span class="n">ProductionVariants</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;InstanceType&quot;</span><span class="p">:</span> <span class="s2">&quot;ml.m5.2xlarge&quot;</span><span class="p">,</span>
            <span class="s2">&quot;InitialInstanceCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;ModelName&quot;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span>
            <span class="s2">&quot;VariantName&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
<span class="p">)</span>

<span class="n">ep_name</span> <span class="o">=</span> <span class="n">best_candidate_name</span> <span class="o">+</span> <span class="n">timestamp_suffix</span> <span class="o">+</span> <span class="s2">&quot;-ep&quot;</span>
<span class="n">create_endpoint_response</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">create_endpoint</span><span class="p">(</span><span class="n">EndpointName</span><span class="o">=</span><span class="n">ep_name</span><span class="p">,</span> <span class="n">EndpointConfigName</span><span class="o">=</span><span class="n">epc_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">get_waiter</span><span class="p">(</span><span class="s2">&quot;endpoint_in_service&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">EndpointName</span><span class="o">=</span><span class="n">ep_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Evaluate">
<h3>Evaluate<a class="headerlink" href="#Evaluate" title="Permalink to this heading">#</a></h3>
<p>Now that we have a hosted endpoint running, we can make real-time predictions from our model very easily, simply by making an http POST request. But first, we’ll need to setup serializers and deserializers for passing our <code class="docutils literal notranslate"><span class="pre">test_data</span></code> NumPy arrays to the model behind the endpoint.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="k">if</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">sagemaker.predictor</span> <span class="kn">import</span> <span class="n">RealTimePredictor</span>
    <span class="kn">from</span> <span class="nn">sagemaker.content_types</span> <span class="kn">import</span> <span class="n">CONTENT_TYPE_CSV</span>

    <span class="n">predictor</span> <span class="o">=</span> <span class="n">RealTimePredictor</span><span class="p">(</span>
        <span class="n">endpoint</span><span class="o">=</span><span class="n">ep_name</span><span class="p">,</span>
        <span class="n">sagemaker_session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span>
        <span class="n">content_type</span><span class="o">=</span><span class="n">CONTENT_TYPE_CSV</span><span class="p">,</span>
        <span class="n">accept</span><span class="o">=</span><span class="n">CONTENT_TYPE_CSV</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Remove the target column from the test data</span>
    <span class="n">test_data_inference</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Churn?&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Obtain predictions from SageMaker endpoint</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
        <span class="n">test_data_inference</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

    <span class="c1"># Load prediction in pandas and compare to ground truth</span>
    <span class="n">prediction_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">prediction</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">&quot;Churn?&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">prediction_df</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">test_data_inference</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy</span><span class="p">))</span>

<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">sagemaker.predictor</span> <span class="kn">import</span> <span class="n">Predictor</span>
    <span class="kn">from</span> <span class="nn">sagemaker.serializers</span> <span class="kn">import</span> <span class="n">CSVSerializer</span>
    <span class="kn">from</span> <span class="nn">sagemaker.deserializers</span> <span class="kn">import</span> <span class="n">CSVDeserializer</span>

    <span class="n">predictor</span> <span class="o">=</span> <span class="n">Predictor</span><span class="p">(</span>
        <span class="n">endpoint_name</span><span class="o">=</span><span class="n">ep_name</span><span class="p">,</span>
        <span class="n">sagemaker_session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span>
        <span class="n">serializer</span><span class="o">=</span><span class="n">CSVSerializer</span><span class="p">(),</span>
        <span class="n">deserializer</span><span class="o">=</span><span class="n">CSVDeserializer</span><span class="p">(),</span>
    <span class="p">)</span>

    <span class="c1"># Remove the target column from the test data</span>
    <span class="n">test_data_inference</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Churn?&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Obtain predictions from SageMaker endpoint</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_inference</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="c1"># Load prediction in pandas and compare to ground truth</span>
    <span class="n">prediction_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">&quot;Churn?&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">prediction_df</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">test_data_inference</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Accuracy: 0.9610194902548725
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>

<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">&quot;Churn?&quot;</span><span class="p">],</span> <span class="n">prediction_df</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">&quot;Churn?&quot;</span><span class="p">],</span> <span class="n">prediction_df</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos_label</span><span class="o">=</span><span class="s2">&quot;True.&quot;</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span>
    <span class="n">test_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">&quot;Churn?&quot;</span><span class="p">],</span> <span class="n">prediction_df</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos_label</span><span class="o">=</span><span class="s2">&quot;True.&quot;</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;binary&quot;</span>
<span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">&quot;Churn?&quot;</span><span class="p">],</span> <span class="n">prediction_df</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos_label</span><span class="o">=</span><span class="s2">&quot;True.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Precision: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Recall: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">recall</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Accuracy: 0.9610194902548725
Precision: 0.896551724137931
Recall: 0.8210526315789474
F1: 0.8571428571428572
</pre></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="Cleanup">
<h2>Cleanup<a class="headerlink" href="#Cleanup" title="Permalink to this heading">#</a></h2>
<p>The Autopilot job creates many underlying artifacts such as dataset splits, preprocessing scripts, or preprocessed data, etc. This code, when un-commented, deletes them. This operation deletes all the generated models and the auto-generated notebooks as well.</p>
<p>s3 = boto3.resource(‘s3’) s3_bucket = s3.Bucket(bucket)</p>
<p>print(s3_bucket) job_outputs_prefix = ‘{}/output/{}’.format(prefix, auto_ml_job_name) print(job_outputs_prefix) #s3_bucket.objects.filter(Prefix=job_outputs_prefix).delete()</p>
<p>Finally, we delete the endpoint and associated resources.</p>
<p>sm.delete_endpoint(EndpointName=ep_name) sm.delete_endpoint_config(EndpointConfigName=epc_name) sm.delete_model(ModelName=model_name)</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../supervised.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Supervised Learning Notebooks</p>
      </div>
    </a>
    <a class="right-next"
       href="../unsupervised.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Unsupervised Learning Notebooks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Contents">Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Data">Data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Upload-the-dataset-to-S3">Upload the dataset to S3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Reserve-some-data-for-calling-inference-on-the-model">Reserve some data for calling inference on the model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setting-up-the-SageMaker-Autopilot-Job">Setting up the SageMaker Autopilot Job</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Launching-the-SageMaker-Autopilot-Job">Launching the SageMaker Autopilot Job</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Tracking-SageMaker-Autopilot-job-progress">Tracking SageMaker Autopilot job progress</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Results">Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Host">Host</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Evaluate">Evaluate</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Cleanup">Cleanup</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/example_notebooks/notebooks/sm-autopilot_customer_churn.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>