
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ExpandingWindowFeatures &#8212; 3.1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=346841c8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=346841c8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=e1ce3931"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script defer data-domain="feature-engine.readthedocs.io" src="https://plausible.io/js/plausible.js"></script>
    <script src="../../../_static/js/copybutton.js?v=84772c1c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/timeseries/forecasting/ExpandingWindowFeatures';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Preprocessing" href="../../preprocessing/index.html" />
    <link rel="prev" title="WindowFeatures" href="WindowFeatures.html" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

    <!-- Cookie banner -->
    <style>
        /* Style for the cookie banner */
        #cookie-banner {
            position: fixed;
            bottom: 0;
            right: 0;
            background-color: #ffe4e1; /* Light Pink */
            color: #333;
            padding: 15px;
            max-width: 400px;
            display: none;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1000; /* Set a higher z-index value */
        }

        #cookie-banner p {
        font-size: 16px; /* Font size for the text */
        color: #333 !important; /* Set link color to black */
        line-height: 1.5; /* Increase line height for added spacing between sentences */
        }

        #cookie-banner a {
            color: #333;
            text-decoration: underline;
        }
    </style>

    <div id="cookie-banner">
        <h2 style="font-size: 20px; margin-bottom: 10px;">This site uses cookies</h2>
        <p style="font-size: 16px;">We use cookies to recognize your visits and preferences, to measure the effectiveness of the documentation, and discover how people find us. With your consent, you're helping us make our documentation better. <br><a href="https://www.trainindata.com/p/privacy" target="_blank">Learn More</a>.</p>
        <button id="cookie-accept">Accept</button>
        <button id="cookie-decline">Decline</button>
    </div>

    <script>
        // JavaScript to show the cookie banner and handle the accept button
        document.addEventListener('DOMContentLoaded', function () {
            var cookieBanner = document.getElementById('cookie-banner');
            var acceptButton = document.getElementById('cookie-accept');
            var declineButton = document.getElementById('cookie-decline');

            // Check if the user has already accepted or declined cookies
            var cookiesAccepted = localStorage.getItem('cookiesAccepted');

            if (!cookiesAccepted) {
                cookieBanner.style.display = 'block';

                acceptButton.addEventListener('click', function () {
                    localStorage.setItem('cookiesAccepted', 'true');
                    loadGoogleAnalytics();
                    cookieBanner.style.display = 'none';
                });

                declineButton.addEventListener('click', function () {
                    localStorage.setItem('cookiesAccepted', 'false');
                    cookieBanner.style.display = 'none';
                });
            } else if (cookiesAccepted === 'true') {
                loadGoogleAnalytics();
            }
        });

        function loadGoogleAnalytics() {
            // Load Google Analytics only if consent is given
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-Z6MPCG673G';
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-Z6MPCG673G');
        }
    </script>
    <!-- Cookie banner -->


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/sageops_logo.png" class="logo__image only-light" alt="3.1 - Home"/>
    <script>document.write(`<img src="../../../_static/sageops_logo.png" class="logo__image only-dark" alt="3.1 - Home"/>`);</script>
  
  
</a></div>
    
      <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../quickstart/index.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../index.html">
                        SageOps User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api_doc/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../example_notebooks/index.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../about/index.html">
                        About
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../quickstart/index.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../index.html">
                        SageOps User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api_doc/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../example_notebooks/index.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../about/index.html">
                        About
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../imputation/index.html">Experiment</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../imputation/MeanMedianImputer.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imputation/ArbitraryNumberImputer.html">Experiment Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imputation/EndTailImputer.html">EndTailImputer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imputation/CategoricalImputer.html">CategoricalImputer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imputation/RandomSampleImputer.html">RandomSampleImputer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imputation/AddMissingIndicator.html">AddMissingIndicator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imputation/DropMissingData.html">DropMissingData</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../encoding/index.html">Categorical Encoding</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../encoding/OneHotEncoder.html">OneHotEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../encoding/OrdinalEncoder.html">Ordinal Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../encoding/CountFrequencyEncoder.html">CountFrequencyEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../encoding/MeanEncoder.html">MeanEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../encoding/WoEEncoder.html">Weight of Evidence (WoE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../encoding/DecisionTreeEncoder.html">DecisionTreeEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../encoding/RareLabelEncoder.html">RareLabelEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../encoding/StringSimilarityEncoder.html">StringSimilarityEncoder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../discretisation/index.html">Discretisation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../discretisation/EqualFrequencyDiscretiser.html">EqualFrequencyDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discretisation/EqualWidthDiscretiser.html">EqualWidthDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discretisation/ArbitraryDiscretiser.html">ArbitraryDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discretisation/DecisionTreeDiscretiser.html">DecisionTreeDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discretisation/GeometricWidthDiscretiser.html">GeometricWidthDiscretiser</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../outliers/index.html">Outlier Handling</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../outliers/Winsorizer.html">Winsorizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../outliers/ArbitraryOutlierCapper.html">ArbitraryOutlierCapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../outliers/OutlierTrimmer.html">OutlierTrimmer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../transformation/index.html">Variance Stabilizing Transformations</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../transformation/LogTransformer.html">LogTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../transformation/LogCpTransformer.html">LogCpTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../transformation/ReciprocalTransformer.html">ReciprocalTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../transformation/ArcsinTransformer.html">ArcsinTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../transformation/PowerTransformer.html">PowerTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../transformation/BoxCoxTransformer.html">BoxCoxTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../transformation/YeoJohnsonTransformer.html">YeoJohnsonTransformer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../scaling/index.html">Scaling</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../scaling/MeanNormalizationScaler.html">MeanNormalizationScaler</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../creation/index.html">Feature Creation</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../creation/CyclicalFeatures.html">CyclicalFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../creation/MathFeatures.html">MathFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../creation/RelativeFeatures.html">RelativeFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../creation/DecisionTreeFeatures.html">DecisionTreeFeatures</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../datetime/index.html">Datetime Features</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../datetime/DatetimeFeatures.html">DatetimeFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../datetime/DatetimeSubtraction.html">DatetimeSubtraction</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../selection/index.html">Feature Selection</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../selection/DropFeatures.html">DropFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/DropConstantFeatures.html">DropConstantFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/DropDuplicateFeatures.html">DropDuplicateFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/DropCorrelatedFeatures.html">DropCorrelatedFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/SmartCorrelatedSelection.html">SmartCorrelatedSelection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/SelectBySingleFeaturePerformance.html">SelectBySingleFeaturePerformance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/RecursiveFeatureElimination.html">RecursiveFeatureElimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/RecursiveFeatureAddition.html">RecursiveFeatureAddition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/SelectByShuffling.html">SelectByShuffling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/SelectByTargetMeanPerformance.html">SelectByTargetMeanPerformance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/DropHighPSIFeatures.html">DropHighPSIFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/SelectByInformationValue.html">SelectByInformationValue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/ProbeFeatureSelection.html">ProbeFeatureSelection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../selection/MRMR.html">MRMR - Minimum Redundancy Maximum Relevance</a></li>
</ul>
</li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Time Series Features</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="reference internal" href="index.html">Forecasting Features</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../preprocessing/index.html">Preprocessing</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../preprocessing/MatchCategories.html">MatchCategories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preprocessing/MatchVariables.html">MatchVariables</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../wrappers/index.html">Scikit-learn Wrapper</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../wrappers/Wrapper.html">SklearnTransformerWrapper</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../pipeline/index.html">Pipeline</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../pipeline/Pipeline.html">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pipeline/make_pipeline.html">make_pipeline</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../variable_handling/index.html">Variable handling functions</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../variable_handling/find_all_variables.html">find_all_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../variable_handling/find_categorical_variables.html">find_categorical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../variable_handling/find_datetime_variables.html">find_datetime_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../variable_handling/find_numerical_variables.html">find_numerical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../variable_handling/find_categorical_and_numerical_variables.html">find_categorical_and_numerical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../variable_handling/check_all_variables.html">check_all_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../variable_handling/check_categorical_variables.html">check_categorical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../variable_handling/check_datetime_variables.html">check_datetime_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../variable_handling/check_numerical_variables.html">check_numerical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../variable_handling/retain_variables_if_in_df.html">retain_variables_if_in_df</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">SageOps User Guide</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Forecasting Features</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">ExpandingWin...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="expandingwindowfeatures">
<span id="expanding-window-features"></span><h1>ExpandingWindowFeatures<a class="headerlink" href="#expandingwindowfeatures" title="Permalink to this heading">#</a></h1>
<p>Window features are variables created by performing mathematical operations over a window
of past data in a time series.</p>
<p><strong>Rolling window features</strong> are created by performing aggregations over a <strong>sliding partition</strong>
(or moving window) of past data points of the time series data. The window size in this case is constant.</p>
<p><strong>Expanding window features</strong> are created by performing aggregations over an <strong>expanding partition</strong>
of past values of the time series. The window size increases as we approach more recent values.</p>
<p>An example of an expanding window feature is the mean value of all the data points prior
to the current row / value. The maximum value of all the rows prior to the current row is
another expanding window feature.</p>
<p>For an expanding window feature to be suitable for forecasting, the window can span
from the start of the data up to, but not including, the first point of forecast.</p>
<p>Expanding window features can be used for forecasting by using traditional machine learning
models, like linear regression.</p>
<section id="expanding-window-features-with-pandas">
<h2>Expanding window features with pandas<a class="headerlink" href="#expanding-window-features-with-pandas" title="Permalink to this heading">#</a></h2>
<p>In Python, we can create expanding window features by utilizing pandas method <code class="docutils literal notranslate"><span class="pre">expanding</span></code>.
For example, by executing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[[</span><span class="s2">&quot;var_1&quot;</span><span class="p">,</span> <span class="s2">&quot;var_2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">expanding</span><span class="p">(</span><span class="n">min_periods</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>With the previous command, we create 2 window features for each variable, <code class="docutils literal notranslate"><span class="pre">var_1</span></code> and
<code class="docutils literal notranslate"><span class="pre">var_2</span></code>, by taking the maximum and average value of all observations up to (and including)
a certain row.</p>
<p>If we want to use those features for forecasting using traditional machine learning algorithms,
we would also shift the window forward with pandas method <code class="docutils literal notranslate"><span class="pre">shift</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[[</span><span class="s2">&quot;var_1&quot;</span><span class="p">,</span> <span class="s2">&quot;var_2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">expanding</span><span class="p">(</span><span class="n">min_periods</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="expanding-window-features-with-feature-engine">
<h2>Expanding window features with Feature-engine<a class="headerlink" href="#expanding-window-features-with-feature-engine" title="Permalink to this heading">#</a></h2>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code> adds expanding window features to the dataframe.</p>
<p>Window features are the result of applying an aggregation operation (e.g., mean,
min, max, etc.) to a variable over a window of past data.</p>
<p>When forecasting the future values of a variable, the past values of that variable are
likely to be predictive. To capitalize on the past values of a variable, we can simply
lag features with <code class="xref py py-class docutils literal notranslate"><span class="pre">LagFeatures</span></code>. We can also create features that summarise the
past values into a single quantity utilising <code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code>.</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code> works on top of <code class="docutils literal notranslate"><span class="pre">pandas.expanding</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.aggregate</span></code>
and <code class="docutils literal notranslate"><span class="pre">pandas.shift</span></code>.</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code> uses <code class="docutils literal notranslate"><span class="pre">pandas.aggregate</span></code> to perform the mathematical
operations over the expanding window. Therefore, you can use any operation supported
by pandas. For supported aggregation functions, see Expanding Window
<a class="reference external" href="https://pandas.pydata.org/docs/reference/window.html">Functions</a>.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">pandas.shift</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code> lags the result of the expanding
window operation. This is useful to ensure that only the information known at predict
time is used to compute the window feature. So if at predict time we only know
the value of a feature at the previous time period and before that, then we should lag the
the window feature by 1 period. If at predict time we only know the value of a feature
from 2 weeks ago and before that, then we should lag the window feature column by 2 weeks.
<code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code> uses a default lag of one period.</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code> will add the new variables with a representative
name to the original dataframe. It also has the methods <code class="docutils literal notranslate"><span class="pre">fit()</span></code> and <code class="docutils literal notranslate"><span class="pre">transform()</span></code>
that make it compatible with the Scikit-learn’s <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> and cross-validation
functions.</p>
<p>Note that, in the current implementation, <code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code> only works with
dataframes whose index, containing the time series timestamp, contains unique values and no NaN.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h2>
<p>Let’s create a toy dataset to demonstrate the functionality of <code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code>.
The dataframe contains 3 numerical variables, a categorical variable, and a datetime
index.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ambient_temp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">31.31</span><span class="p">,</span> <span class="mf">31.51</span><span class="p">,</span> <span class="mf">32.15</span><span class="p">,</span> <span class="mf">32.39</span><span class="p">,</span> <span class="mf">32.62</span><span class="p">,</span> <span class="mf">32.5</span><span class="p">,</span> <span class="mf">32.52</span><span class="p">,</span> <span class="mf">32.68</span><span class="p">],</span>
     <span class="s2">&quot;module_temp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">49.18</span><span class="p">,</span> <span class="mf">49.84</span><span class="p">,</span> <span class="mf">52.35</span><span class="p">,</span> <span class="mf">50.63</span><span class="p">,</span> <span class="mf">49.61</span><span class="p">,</span> <span class="mf">47.01</span><span class="p">,</span> <span class="mf">46.67</span><span class="p">,</span> <span class="mf">47.52</span><span class="p">],</span>
     <span class="s2">&quot;irradiation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.76</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">],</span>
     <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
     <span class="p">}</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2020-05-15 12:00:00&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;15min&quot;</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">y</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span>

<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p>Below we see the output of our toy dataframe:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                     <span class="n">ambient_temp</span>  <span class="n">module_temp</span>  <span class="n">irradiation</span>  <span class="n">color</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">31.31</span>        <span class="mf">49.18</span>         <span class="mf">0.51</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">31.51</span>        <span class="mf">49.84</span>         <span class="mf">0.79</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.15</span>        <span class="mf">52.35</span>         <span class="mf">0.65</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.39</span>        <span class="mf">50.63</span>         <span class="mf">0.76</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.62</span>        <span class="mf">49.61</span>         <span class="mf">0.42</span>   <span class="n">blue</span>
</pre></div>
</div>
<p>Let’s now print out the target:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
<p>Below we see the target variable:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mi">1</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>    <span class="mi">2</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>    <span class="mi">3</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>    <span class="mi">4</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mi">5</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>    <span class="mi">6</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>    <span class="mi">7</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>    <span class="mi">8</span>
<span class="n">Freq</span><span class="p">:</span> <span class="mi">15</span><span class="nb">min</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>Now we will create expanding window features from the numerical variables. In <code class="docutils literal notranslate"><span class="pre">functions</span></code>,
we indicate all the operations that we want to perform over those windows. In
our example below, we want to calculate the mean and the standard deviation of the
data within those windows and also find the maximum value within the windows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">feature_engine.timeseries.forecasting</span> <span class="kn">import</span> <span class="n">ExpandingWindowFeatures</span>

<span class="n">win_f</span> <span class="o">=</span> <span class="n">ExpandingWindowFeatures</span><span class="p">(</span><span class="n">functions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">])</span>

<span class="n">X_tr</span> <span class="o">=</span> <span class="n">win_f</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">X_tr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p>We can find the window features on the right side of the dataframe.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                     <span class="n">ambient_temp</span>  <span class="n">module_temp</span>  <span class="n">irradiation</span>  <span class="n">color</span>  \
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">31.31</span>        <span class="mf">49.18</span>         <span class="mf">0.51</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">31.51</span>        <span class="mf">49.84</span>         <span class="mf">0.79</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.15</span>        <span class="mf">52.35</span>         <span class="mf">0.65</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.39</span>        <span class="mf">50.63</span>         <span class="mf">0.76</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.62</span>        <span class="mf">49.61</span>         <span class="mf">0.42</span>   <span class="n">blue</span>

                     <span class="n">ambient_temp_expanding_mean</span>  <span class="n">ambient_temp_expanding_max</span>  \
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                          <span class="n">NaN</span>                         <span class="n">NaN</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.310000</span>                       <span class="mf">31.31</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.410000</span>                       <span class="mf">31.51</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.656667</span>                       <span class="mf">32.15</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.840000</span>                       <span class="mf">32.39</span>

                     <span class="n">ambient_temp_expanding_std</span>  <span class="n">module_temp_expanding_mean</span>  \
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                         <span class="n">NaN</span>                         <span class="n">NaN</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>                         <span class="n">NaN</span>                   <span class="mf">49.180000</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">0.141421</span>                   <span class="mf">49.510000</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">0.438786</span>                   <span class="mf">50.456667</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">0.512640</span>                   <span class="mf">50.500000</span>

                     <span class="n">module_temp_expanding_max</span>  <span class="n">module_temp_expanding_std</span>  \
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                        <span class="n">NaN</span>                        <span class="n">NaN</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">49.18</span>                        <span class="n">NaN</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">49.84</span>                   <span class="mf">0.466690</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">52.35</span>                   <span class="mf">1.672553</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">52.35</span>                   <span class="mf">1.368381</span>

                     <span class="n">irradiation_expanding_mean</span>  <span class="n">irradiation_expanding_max</span>  \
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                         <span class="n">NaN</span>                        <span class="n">NaN</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">0.5100</span>                       <span class="mf">0.51</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">0.6500</span>                       <span class="mf">0.79</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">0.6500</span>                       <span class="mf">0.79</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">0.6775</span>                       <span class="mf">0.79</span>

                     <span class="n">irradiation_expanding_std</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                        <span class="n">NaN</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>                        <span class="n">NaN</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>                   <span class="mf">0.197990</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>                   <span class="mf">0.140000</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                   <span class="mf">0.126853</span>
</pre></div>
</div>
<p>The variables used as input for the window features are stored in the <code class="docutils literal notranslate"><span class="pre">variables_</span></code>
attribute of the <code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">win_f</span><span class="o">.</span><span class="n">variables_</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;ambient_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;module_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;irradiation&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>We can obtain the names of the variables in the returned dataframe using the
<code class="docutils literal notranslate"><span class="pre">get_feature_names_out()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">win_f</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;ambient_temp&#39;</span><span class="p">,</span>
 <span class="s1">&#39;module_temp&#39;</span><span class="p">,</span>
 <span class="s1">&#39;irradiation&#39;</span><span class="p">,</span>
 <span class="s1">&#39;color&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ambient_temp_expanding_mean&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ambient_temp_expanding_max&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ambient_temp_expanding_std&#39;</span><span class="p">,</span>
 <span class="s1">&#39;module_temp_expanding_mean&#39;</span><span class="p">,</span>
 <span class="s1">&#39;module_temp_expanding_max&#39;</span><span class="p">,</span>
 <span class="s1">&#39;module_temp_expanding_std&#39;</span><span class="p">,</span>
 <span class="s1">&#39;irradiation_expanding_mean&#39;</span><span class="p">,</span>
 <span class="s1">&#39;irradiation_expanding_max&#39;</span><span class="p">,</span>
 <span class="s1">&#39;irradiation_expanding_std&#39;</span><span class="p">]</span>
</pre></div>
</div>
<section id="dropping-rows-with-nan">
<h3>Dropping rows with nan<a class="headerlink" href="#dropping-rows-with-nan" title="Permalink to this heading">#</a></h3>
<p>When we create window features using expanding windows, we may introduce nan values for
those data points where there isn’t enough data in the past to create the windows. We
can automatically drop the rows with nan values in the window features both in the train
set and in the target variable as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">win_f</span> <span class="o">=</span> <span class="n">ExpandingWindowFeatures</span><span class="p">(</span>
    <span class="n">functions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span>
    <span class="n">drop_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">win_f</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span> <span class="o">=</span> <span class="n">win_f</span><span class="o">.</span><span class="n">transform_x_y</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_tr</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<p>We see that the resulting dataframe contains less rows than the original dataframe:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,))</span>
</pre></div>
</div>
</section>
<section id="imputing-rows-with-nan">
<h3>Imputing rows with nan<a class="headerlink" href="#imputing-rows-with-nan" title="Permalink to this heading">#</a></h3>
<p>If instead of removing the row with nan in the expanding window features, we want to impute those
values, we can do so with any of Feature-engine’s imputers. Here, we will replace nan with
the median value of the resulting window features, using the <code class="docutils literal notranslate"><span class="pre">MeanMedianImputer</span></code> within
a pipeline:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">feature_engine.imputation</span> <span class="kn">import</span> <span class="n">MeanMedianImputer</span>
<span class="kn">from</span> <span class="nn">feature_engine.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>

<span class="n">win_f</span> <span class="o">=</span> <span class="n">ExpandingWindowFeatures</span><span class="p">(</span><span class="n">functions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">])</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;windows&quot;</span><span class="p">,</span> <span class="n">win_f</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">MeanMedianImputer</span><span class="p">(</span><span class="n">imputation_method</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">))</span>
<span class="p">])</span>

<span class="n">X_tr</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_tr</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<p>We see the resulting dataframe, where the nan values were replaced with the median:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                     <span class="n">ambient_temp</span>  <span class="n">module_temp</span>  <span class="n">irradiation</span>  <span class="n">color</span>  \
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">31.31</span>        <span class="mf">49.18</span>         <span class="mf">0.51</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">31.51</span>        <span class="mf">49.84</span>         <span class="mf">0.79</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.15</span>        <span class="mf">52.35</span>         <span class="mf">0.65</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.39</span>        <span class="mf">50.63</span>         <span class="mf">0.76</span>  <span class="n">green</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.62</span>        <span class="mf">49.61</span>         <span class="mf">0.42</span>   <span class="n">blue</span>

                     <span class="n">ambient_temp_expanding_mean</span>  <span class="n">ambient_temp_expanding_std</span>  \
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.840000</span>                    <span class="mf">0.518740</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.310000</span>                    <span class="mf">0.518740</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.410000</span>                    <span class="mf">0.141421</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.656667</span>                    <span class="mf">0.438786</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.840000</span>                    <span class="mf">0.512640</span>

                     <span class="n">module_temp_expanding_mean</span>  <span class="n">module_temp_expanding_std</span>  \
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                   <span class="mf">49.770000</span>                   <span class="mf">1.520467</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>                   <span class="mf">49.180000</span>                   <span class="mf">1.520467</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>                   <span class="mf">49.510000</span>                   <span class="mf">0.466690</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>                   <span class="mf">50.456667</span>                   <span class="mf">1.672553</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                   <span class="mf">50.500000</span>                   <span class="mf">1.368381</span>

                     <span class="n">irradiation_expanding_mean</span>  <span class="n">irradiation_expanding_std</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">0.6260</span>                   <span class="mf">0.146424</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">0.5100</span>                   <span class="mf">0.146424</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">0.6500</span>                   <span class="mf">0.197990</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">0.6500</span>                   <span class="mf">0.140000</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                      <span class="mf">0.6775</span>                   <span class="mf">0.126853</span>
</pre></div>
</div>
</section>
<section id="working-with-pandas-series">
<h3>Working with pandas series<a class="headerlink" href="#working-with-pandas-series" title="Permalink to this heading">#</a></h3>
<p>If your time series is a pandas Series instead of a pandas Dataframe, you need to
transform it into a dataframe before using <code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code>.</p>
<p>The following is a pandas Series:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[</span><span class="s1">&#39;ambient_temp&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">31.31</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">31.51</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">32.15</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">32.39</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">32.62</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">32.50</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">32.52</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">32.68</span>
<span class="n">Freq</span><span class="p">:</span> <span class="mi">15</span><span class="n">T</span><span class="p">,</span> <span class="n">Name</span><span class="p">:</span> <span class="n">ambient_temp</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>We can use <code class="xref py py-class docutils literal notranslate"><span class="pre">ExpandingWindowFeatures</span></code> to create, for example, 2 new expanding window
features by finding the mean and maximum value of a pandas Series if we convert
it to a pandas Dataframe using the method <code class="docutils literal notranslate"><span class="pre">to_frame()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">win_f</span> <span class="o">=</span> <span class="n">ExpandingWindowFeatures</span><span class="p">(</span><span class="n">functions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span>

<span class="n">X_tr</span> <span class="o">=</span> <span class="n">win_f</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="s1">&#39;ambient_temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">())</span>

<span class="n">X_tr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                     <span class="n">ambient_temp</span>  <span class="n">ambient_temp_expanding_mean</span>  \
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">31.31</span>                          <span class="n">NaN</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">31.51</span>                    <span class="mf">31.310000</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.15</span>                    <span class="mf">31.410000</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.39</span>                    <span class="mf">31.656667</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>         <span class="mf">32.62</span>                    <span class="mf">31.840000</span>

                     <span class="n">ambient_temp_expanding_max</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                         <span class="n">NaN</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>                       <span class="mf">31.31</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>                       <span class="mf">31.51</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>                       <span class="mf">32.15</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                       <span class="mf">32.39</span>
</pre></div>
</div>
<p>And if we do not want the original values of time series in the returned dataframe, we
just need to remember to drop the original series after the transformation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">win_f</span> <span class="o">=</span> <span class="n">ExpandingWindowFeatures</span><span class="p">(</span>
    <span class="n">functions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">],</span>
    <span class="n">drop_original</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">X_tr</span> <span class="o">=</span> <span class="n">win_f</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="s1">&#39;ambient_temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">())</span>

<span class="n">X_tr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                     <span class="n">ambient_temp_expanding_mean</span>  <span class="n">ambient_temp_expanding_max</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                          <span class="n">NaN</span>                         <span class="n">NaN</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.310000</span>                       <span class="mf">31.31</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.410000</span>                       <span class="mf">31.51</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">12</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.656667</span>                       <span class="mf">32.15</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                    <span class="mf">31.840000</span>                       <span class="mf">32.39</span>
</pre></div>
</div>
</section>
<section id="getting-the-name-of-the-new-features">
<h3>Getting the name of the new features<a class="headerlink" href="#getting-the-name-of-the-new-features" title="Permalink to this heading">#</a></h3>
<p>We can easily obtain the name of the original and new variables with the method
<code class="docutils literal notranslate"><span class="pre">get_feature_names_out</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">win_f</span> <span class="o">=</span> <span class="n">ExpandingWindowFeatures</span><span class="p">()</span>

<span class="n">win_f</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">win_f</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;ambient_temp&#39;</span><span class="p">,</span>
 <span class="s1">&#39;module_temp&#39;</span><span class="p">,</span>
 <span class="s1">&#39;irradiation&#39;</span><span class="p">,</span>
 <span class="s1">&#39;color&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ambient_temp_expanding_mean&#39;</span><span class="p">,</span>
 <span class="s1">&#39;module_temp_expanding_mean&#39;</span><span class="p">,</span>
 <span class="s1">&#39;irradiation_expanding_mean&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="see-also">
<h2>See also<a class="headerlink" href="#see-also" title="Permalink to this heading">#</a></h2>
<p>Check out the additional transformers to create rolling window features
(<code class="xref py py-class docutils literal notranslate"><span class="pre">WindowFeatures</span></code>) or lag features, by lagging past values of the time
series data (<code class="xref py py-class docutils literal notranslate"><span class="pre">LagFeatures</span></code>).</p>
</section>
<section id="tutorials-and-courses">
<h2>Tutorials and courses<a class="headerlink" href="#tutorials-and-courses" title="Permalink to this heading">#</a></h2>
<p>For tutorials about this and other feature engineering methods for time series forecasting
check out our online courses:</p>
<figure class="align-center align-left" id="id1">
<a class="reference external image-reference" href="https://www.trainindata.com/p/feature-engineering-for-forecasting"><img alt="../../../_images/fetsf.png" src="../../../_images/fetsf.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text">Feature Engineering for Time Series Forecasting</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center align-left" id="id2">
<a class="reference external image-reference" href="https://www.courses.trainindata.com/p/forecasting-with-machine-learning"><img alt="../../../_images/fwml.png" src="../../../_images/fwml.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text">Forecasting with Machine Learning</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>Our courses are suitable for beginners and more advanced data scientists looking to
forecast time series using traditional machine learning models, like linear regression
or gradient boosting machines.</p>
<p>By purchasing them you are supporting Sole, the main developer of Feature-engine.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="WindowFeatures.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">WindowFeatures</p>
      </div>
    </a>
    <a class="right-next"
       href="../../preprocessing/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Preprocessing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expanding-window-features-with-pandas">Expanding window features with pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expanding-window-features-with-feature-engine">Expanding window features with Feature-engine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dropping-rows-with-nan">Dropping rows with nan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imputing-rows-with-nan">Imputing rows with nan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-pandas-series">Working with pandas series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-name-of-the-new-features">Getting the name of the new features</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#see-also">See also</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorials-and-courses">Tutorials and courses</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../_sources/user_guide/timeseries/forecasting/ExpandingWindowFeatures.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>