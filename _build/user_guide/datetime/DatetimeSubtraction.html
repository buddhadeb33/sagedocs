
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DatetimeSubtraction &#8212; 3.1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=346841c8" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=346841c8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=e1ce3931"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script defer data-domain="feature-engine.readthedocs.io" src="https://plausible.io/js/plausible.js"></script>
    <script src="../../_static/js/copybutton.js?v=84772c1c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/datetime/DatetimeSubtraction';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Feature Selection" href="../selection/index.html" />
    <link rel="prev" title="DatetimeFeatures" href="DatetimeFeatures.html" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

    <!-- Cookie banner -->
    <style>
        /* Style for the cookie banner */
        #cookie-banner {
            position: fixed;
            bottom: 0;
            right: 0;
            background-color: #ffe4e1; /* Light Pink */
            color: #333;
            padding: 15px;
            max-width: 400px;
            display: none;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1000; /* Set a higher z-index value */
        }

        #cookie-banner p {
        font-size: 16px; /* Font size for the text */
        color: #333 !important; /* Set link color to black */
        line-height: 1.5; /* Increase line height for added spacing between sentences */
        }

        #cookie-banner a {
            color: #333;
            text-decoration: underline;
        }
    </style>

    <div id="cookie-banner">
        <h2 style="font-size: 20px; margin-bottom: 10px;">This site uses cookies</h2>
        <p style="font-size: 16px;">We use cookies to recognize your visits and preferences, to measure the effectiveness of the documentation, and discover how people find us. With your consent, you're helping us make our documentation better. <br><a href="https://www.trainindata.com/p/privacy" target="_blank">Learn More</a>.</p>
        <button id="cookie-accept">Accept</button>
        <button id="cookie-decline">Decline</button>
    </div>

    <script>
        // JavaScript to show the cookie banner and handle the accept button
        document.addEventListener('DOMContentLoaded', function () {
            var cookieBanner = document.getElementById('cookie-banner');
            var acceptButton = document.getElementById('cookie-accept');
            var declineButton = document.getElementById('cookie-decline');

            // Check if the user has already accepted or declined cookies
            var cookiesAccepted = localStorage.getItem('cookiesAccepted');

            if (!cookiesAccepted) {
                cookieBanner.style.display = 'block';

                acceptButton.addEventListener('click', function () {
                    localStorage.setItem('cookiesAccepted', 'true');
                    loadGoogleAnalytics();
                    cookieBanner.style.display = 'none';
                });

                declineButton.addEventListener('click', function () {
                    localStorage.setItem('cookiesAccepted', 'false');
                    cookieBanner.style.display = 'none';
                });
            } else if (cookiesAccepted === 'true') {
                loadGoogleAnalytics();
            }
        });

        function loadGoogleAnalytics() {
            // Load Google Analytics only if consent is given
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-Z6MPCG673G';
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-Z6MPCG673G');
        }
    </script>
    <!-- Cookie banner -->


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/sageops_logo.png" class="logo__image only-light" alt="3.1 - Home"/>
    <script>document.write(`<img src="../../_static/sageops_logo.png" class="logo__image only-dark" alt="3.1 - Home"/>`);</script>
  
  
</a></div>
    
      <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../quickstart/index.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        SageOps User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api_doc/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../example_notebooks/index.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../about/index.html">
                        About
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../quickstart/index.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        SageOps User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api_doc/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../example_notebooks/index.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../about/index.html">
                        About
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../imputation/index.html">Experiment</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../imputation/MeanMedianImputer.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/ArbitraryNumberImputer.html">Experiment Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/EndTailImputer.html">EndTailImputer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/CategoricalImputer.html">CategoricalImputer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/RandomSampleImputer.html">RandomSampleImputer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/AddMissingIndicator.html">AddMissingIndicator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/DropMissingData.html">DropMissingData</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../encoding/index.html">Categorical Encoding</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../encoding/OneHotEncoder.html">OneHotEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../encoding/OrdinalEncoder.html">Ordinal Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../encoding/CountFrequencyEncoder.html">CountFrequencyEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../encoding/MeanEncoder.html">MeanEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../encoding/WoEEncoder.html">Weight of Evidence (WoE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../encoding/DecisionTreeEncoder.html">DecisionTreeEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../encoding/RareLabelEncoder.html">RareLabelEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../encoding/StringSimilarityEncoder.html">StringSimilarityEncoder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../discretisation/index.html">Discretisation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../discretisation/EqualFrequencyDiscretiser.html">EqualFrequencyDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discretisation/EqualWidthDiscretiser.html">EqualWidthDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discretisation/ArbitraryDiscretiser.html">ArbitraryDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discretisation/DecisionTreeDiscretiser.html">DecisionTreeDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discretisation/GeometricWidthDiscretiser.html">GeometricWidthDiscretiser</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../outliers/index.html">Outlier Handling</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../outliers/Winsorizer.html">Winsorizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outliers/ArbitraryOutlierCapper.html">ArbitraryOutlierCapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outliers/OutlierTrimmer.html">OutlierTrimmer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../transformation/index.html">Variance Stabilizing Transformations</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../transformation/LogTransformer.html">LogTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/LogCpTransformer.html">LogCpTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/ReciprocalTransformer.html">ReciprocalTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/ArcsinTransformer.html">ArcsinTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/PowerTransformer.html">PowerTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/BoxCoxTransformer.html">BoxCoxTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/YeoJohnsonTransformer.html">YeoJohnsonTransformer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../scaling/index.html">Scaling</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../scaling/MeanNormalizationScaler.html">MeanNormalizationScaler</a></li>
</ul>
</li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../creation/index.html">Feature Creation</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../creation/CyclicalFeatures.html">CyclicalFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../creation/MathFeatures.html">MathFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../creation/RelativeFeatures.html">RelativeFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../creation/DecisionTreeFeatures.html">DecisionTreeFeatures</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Datetime Features</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="DatetimeFeatures.html">DatetimeFeatures</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">DatetimeSubtraction</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../selection/index.html">Feature Selection</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../selection/DropFeatures.html">DropFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/DropConstantFeatures.html">DropConstantFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/DropDuplicateFeatures.html">DropDuplicateFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/DropCorrelatedFeatures.html">DropCorrelatedFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/SmartCorrelatedSelection.html">SmartCorrelatedSelection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/SelectBySingleFeaturePerformance.html">SelectBySingleFeaturePerformance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/RecursiveFeatureElimination.html">RecursiveFeatureElimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/RecursiveFeatureAddition.html">RecursiveFeatureAddition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/SelectByShuffling.html">SelectByShuffling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/SelectByTargetMeanPerformance.html">SelectByTargetMeanPerformance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/DropHighPSIFeatures.html">DropHighPSIFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/SelectByInformationValue.html">SelectByInformationValue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/ProbeFeatureSelection.html">ProbeFeatureSelection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/MRMR.html">MRMR - Minimum Redundancy Maximum Relevance</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../timeseries/index.html">Time Series Features</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../timeseries/forecasting/index.html">Forecasting Features</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../preprocessing/index.html">Preprocessing</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/MatchCategories.html">MatchCategories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/MatchVariables.html">MatchVariables</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../wrappers/index.html">Scikit-learn Wrapper</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../wrappers/Wrapper.html">SklearnTransformerWrapper</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../pipeline/index.html">Pipeline</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/Pipeline.html">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/make_pipeline.html">make_pipeline</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../variable_handling/index.html">Variable handling functions</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/find_all_variables.html">find_all_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/find_categorical_variables.html">find_categorical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/find_datetime_variables.html">find_datetime_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/find_numerical_variables.html">find_numerical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/find_categorical_and_numerical_variables.html">find_categorical_and_numerical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/check_all_variables.html">check_all_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/check_categorical_variables.html">check_categorical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/check_datetime_variables.html">check_datetime_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/check_numerical_variables.html">check_numerical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/retain_variables_if_in_df.html">retain_variables_if_in_df</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">SageOps User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Datetime Features</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">DatetimeSubtraction</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="datetimesubtraction">
<span id="datetime-subtraction"></span><h1>DatetimeSubtraction<a class="headerlink" href="#datetimesubtraction" title="Permalink to this heading">#</a></h1>
<p>Very often, we have datetime variables in our datasets, and we want to determine the time
difference between them. For example, if we work with financial data, we may have the
variable <strong>date of loan application</strong>, with the date and time when the customer applied for
a loan, and also the variable <strong>date of birth</strong>, with the customer’s date of birth. With those
two variables, we want to infer the <strong>age of the customer</strong> at the time of application. In order
to do this, we can compute the difference in years between <code class="docutils literal notranslate"><span class="pre">date_of_loan_application</span></code> and
<code class="docutils literal notranslate"><span class="pre">date_of_birth</span></code> and capture it in a new variable.</p>
<p>In a different example, if we are trying to predict the price of the house and we have
information about the year in which the house was built, we can infer the age of the house
at the point of sale. Generally, older houses cost less. To calculate the age of the house,
we’d simply compute the difference in years between the sale date and the date at which
it was built.</p>
<p>The Python program offers many options for making operations between datetime objects, like,
for example, the datetime module. Since most likely you will be working with Pandas dataframes,
we will focus this guide on pandas and then how we can automate the procedure with Feature-engine.</p>
<section id="subtracting-datetime-features-with-pandas">
<h2>Subtracting datetime features with pandas<a class="headerlink" href="#subtracting-datetime-features-with-pandas" title="Permalink to this heading">#</a></h2>
<p>In Python, we can subtract datetime objects with pandas. To work with datetime variables
in pandas, we need to make sure that the timestamp, which can be represented in various
formats, like strings (str), objects (<code class="docutils literal notranslate"><span class="pre">&quot;O&quot;</span></code>), or datetime, is cast as a datetime. If not, we
can convert strings to datetime objects by executing <code class="docutils literal notranslate"><span class="pre">pd.to_datetime(df[variable_of_interest])</span></code>.</p>
<p>Let’s create a toy dataframe with 2 datetime variables for a short demo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;date1&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2019-03-05&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">),</span>
    <span class="s2">&quot;date2&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2018-03-05&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>This is the data that we created, containing two datetime variables:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>       <span class="n">date1</span>      <span class="n">date2</span>
<span class="mi">0</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">11</span>
<span class="mi">1</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">18</span>
<span class="mi">2</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">07</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">25</span>
<span class="mi">3</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">08</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span>
<span class="mi">4</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">09</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">08</span>
</pre></div>
</div>
<p>Now, we can subtract <code class="docutils literal notranslate"><span class="pre">date2</span></code> from <code class="docutils literal notranslate"><span class="pre">date1</span></code> and capture the difference in a new variable by
utilizing the pandas subtraction operator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;date2&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>The new variable, which expresses the difference in number of days, is at the right of the
dataframe:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>       <span class="n">date1</span>      <span class="n">date2</span>     <span class="n">diff</span>
<span class="mi">0</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">11</span> <span class="mi">359</span> <span class="n">days</span>
<span class="mi">1</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">18</span> <span class="mi">353</span> <span class="n">days</span>
<span class="mi">2</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">07</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">25</span> <span class="mi">347</span> <span class="n">days</span>
<span class="mi">3</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">08</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span> <span class="mi">341</span> <span class="n">days</span>
<span class="mi">4</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">09</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">08</span> <span class="mi">335</span> <span class="n">days</span>
</pre></div>
</div>
<p>If we want the units in something other than days, we can use numpy’s timedelta. The following
example shows how to use this syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;date2&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;timedelta64[ns]&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>We see the new variable now expressing the difference in years, at the right of the dataframe:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>       <span class="n">date1</span>      <span class="n">date2</span>      <span class="n">diff</span>
<span class="mi">0</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">11</span>  <span class="mf">0.982909</span>
<span class="mi">1</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">18</span>  <span class="mf">0.966481</span>
<span class="mi">2</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">07</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">25</span>  <span class="mf">0.950054</span>
<span class="mi">3</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">08</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span>  <span class="mf">0.933626</span>
<span class="mi">4</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">09</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">08</span>  <span class="mf">0.917199</span>
</pre></div>
</div>
<p>If you wanted to subtract various datetime variables, you would have to write lines of code
for every subtraction. Fortunately, we can automate this procedure with <code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeSubstraction()</span></code>.</p>
</section>
<section id="datetime-subtraction-with-feature-engine">
<h2>Datetime subtraction with Feature-engine<a class="headerlink" href="#datetime-subtraction-with-feature-engine" title="Permalink to this heading">#</a></h2>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeSubstraction()</span></code> automatically subtracts several date and time features from
each other. You just need to indicate the features at the right of the subtraction operation
in the <code class="docutils literal notranslate"><span class="pre">variables</span></code> parameters and those on the left in the <code class="docutils literal notranslate"><span class="pre">reference</span> <span class="pre">parameter</span></code>. You can also
change the output unit through the <code class="docutils literal notranslate"><span class="pre">output_unit</span></code> parameter.</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeSubstraction()</span></code> works with variables whose <code class="docutils literal notranslate"><span class="pre">dtype</span></code> is datetime, as well as
with object-like and categorical variables, provided that they can be parsed into datetime
format. This will be done under the hood by the transformer.</p>
<p>Following up with the former example, here is how we obtain the difference in number of
days using <code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeSubstraction()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">feature_engine.datetime</span> <span class="kn">import</span> <span class="n">DatetimeSubtraction</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;date1&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2019-03-05&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">),</span>
    <span class="s2">&quot;date2&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2018-03-05&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)})</span>

<span class="n">dtf</span> <span class="o">=</span> <span class="n">DatetimeSubtraction</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="s2">&quot;date1&quot;</span><span class="p">,</span>
    <span class="n">reference</span><span class="o">=</span><span class="s2">&quot;date2&quot;</span><span class="p">,</span>
    <span class="n">output_unit</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">dtf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">transform()</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeSubstraction()</span></code> returns a new dataframe containing the
original variables and also the new variables with the time difference:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>       <span class="n">date1</span>      <span class="n">date2</span>  <span class="n">date1_sub_date2</span>
<span class="mi">0</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">11</span>         <span class="mf">0.982909</span>
<span class="mi">1</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">18</span>         <span class="mf">0.966481</span>
<span class="mi">2</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">07</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">25</span>         <span class="mf">0.950054</span>
<span class="mi">3</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">08</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span>         <span class="mf">0.933626</span>
<span class="mi">4</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">09</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">08</span>         <span class="mf">0.917199</span>
</pre></div>
</div>
<section id="drop-original-variables-after-computation">
<h3>Drop original variables after computation<a class="headerlink" href="#drop-original-variables-after-computation" title="Permalink to this heading">#</a></h3>
<p>We have the option to drop the original datetime variables after the computation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">feature_engine.datetime</span> <span class="kn">import</span> <span class="n">DatetimeSubtraction</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;date1&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2019-03-05&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">),</span>
    <span class="s2">&quot;date2&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2018-03-05&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)})</span>

<span class="n">dtf</span> <span class="o">=</span> <span class="n">DatetimeSubtraction</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="s2">&quot;date1&quot;</span><span class="p">,</span>
    <span class="n">reference</span><span class="o">=</span><span class="s2">&quot;date2&quot;</span><span class="p">,</span>
    <span class="n">output_unit</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span>
    <span class="n">drop_original</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">dtf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the resulting dataframe contains only the time difference between the two
original variables:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">date1_sub_date2</span>
<span class="mi">0</span>        <span class="mf">11.794903</span>
<span class="mi">1</span>        <span class="mf">11.597774</span>
<span class="mi">2</span>        <span class="mf">11.400645</span>
<span class="mi">3</span>        <span class="mf">11.203515</span>
<span class="mi">4</span>        <span class="mf">11.006386</span>
</pre></div>
</div>
</section>
<section id="subtract-multiple-variables-simultaneously">
<h3>Subtract multiple variables simultaneously<a class="headerlink" href="#subtract-multiple-variables-simultaneously" title="Permalink to this heading">#</a></h3>
<p>We can perform multiple subtractions at the same time. In this example, we will add new
datetime variables to the toy dataframe as strings. The idea is to show that
<code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeSubstraction()</span></code> will convert those strings to datetime under the hood to
carry out the subtraction operation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">feature_engine.datetime</span> <span class="kn">import</span> <span class="n">DatetimeSubtraction</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;date1&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-09-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-10-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-12-01&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date2&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-09-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-10-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-12-15&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date3&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-08-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-09-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-11-01&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date4&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-08-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-09-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-11-15&quot;</span><span class="p">],</span>
<span class="p">})</span>

<span class="n">dtf</span> <span class="o">=</span> <span class="n">DatetimeSubtraction</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">,</span> <span class="s2">&quot;date2&quot;</span><span class="p">],</span> <span class="n">reference</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date3&quot;</span><span class="p">,</span> <span class="s2">&quot;date4&quot;</span><span class="p">])</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">dtf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting dataframe contains the original variables plus the  new variables expressing
the time difference between the date objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">date1</span>       <span class="n">date2</span>       <span class="n">date3</span>       <span class="n">date4</span>  <span class="n">date1_sub_date3</span>  \
<span class="mi">0</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">15</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">15</span>             <span class="mf">31.0</span>
<span class="mi">1</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">15</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">15</span>             <span class="mf">30.0</span>
<span class="mi">2</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">15</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">15</span>             <span class="mf">30.0</span>

   <span class="n">date2_sub_date3</span>  <span class="n">date1_sub_date4</span>  <span class="n">date2_sub_date4</span>
<span class="mi">0</span>             <span class="mf">45.0</span>             <span class="mf">17.0</span>             <span class="mf">31.0</span>
<span class="mi">1</span>             <span class="mf">44.0</span>             <span class="mf">16.0</span>             <span class="mf">30.0</span>
<span class="mi">2</span>             <span class="mf">44.0</span>             <span class="mf">16.0</span>             <span class="mf">30.0</span>
</pre></div>
</div>
</section>
<section id="working-with-missing-values">
<h3>Working with missing values<a class="headerlink" href="#working-with-missing-values" title="Permalink to this heading">#</a></h3>
<p>By default, <code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeSubstraction()</span></code>  will raise an error if the dataframe passed
to the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> or <code class="docutils literal notranslate"><span class="pre">transform()</span></code> methods contains NA in the variables to subtract. We can
override this behaviour and allow computations between variables with nan by setting the
parameter <code class="docutils literal notranslate"><span class="pre">missing_values</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;ignore&quot;</span></code>. Here is a code example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">feature_engine.datetime</span> <span class="kn">import</span> <span class="n">DatetimeSubtraction</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;date1&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-09-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-10-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-12-01&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date2&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-09-15&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;2022-12-15&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date3&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-08-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-09-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-11-01&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date4&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-08-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-09-15&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">})</span>

<span class="n">dtf</span> <span class="o">=</span> <span class="n">DatetimeSubtraction</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">,</span> <span class="s2">&quot;date2&quot;</span><span class="p">],</span>
    <span class="n">reference</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date3&quot;</span><span class="p">,</span> <span class="s2">&quot;date4&quot;</span><span class="p">],</span>
    <span class="n">missing_values</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">dtf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>When any of the variables contains NAN, the new features with the time difference will also
display NANs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">date1</span>       <span class="n">date2</span>       <span class="n">date3</span>       <span class="n">date4</span>  <span class="n">date1_sub_date3</span>  \
<span class="mi">0</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">15</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">15</span>             <span class="mf">31.0</span>
<span class="mi">1</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>         <span class="n">NaN</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">15</span>             <span class="mf">30.0</span>
<span class="mi">2</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">15</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">01</span>         <span class="n">NaN</span>             <span class="mf">30.0</span>

   <span class="n">date2_sub_date3</span>  <span class="n">date1_sub_date4</span>  <span class="n">date2_sub_date4</span>
<span class="mi">0</span>             <span class="mf">45.0</span>             <span class="mf">17.0</span>             <span class="mf">31.0</span>
<span class="mi">1</span>              <span class="n">NaN</span>             <span class="mf">16.0</span>              <span class="n">NaN</span>
<span class="mi">2</span>             <span class="mf">44.0</span>              <span class="n">NaN</span>              <span class="n">NaN</span>
</pre></div>
</div>
</section>
<section id="working-with-different-timezones">
<h3>Working with different timezones<a class="headerlink" href="#working-with-different-timezones" title="Permalink to this heading">#</a></h3>
<p>If we have timestamps in different timezones or variables in different timezones, we can
still perform subtraction operations with <code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeSubstraction()</span></code> by first setting
all timestamps to the universal central time zone. Here is a code example, were we return
the time difference in microseconds:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">feature_engine.datetime</span> <span class="kn">import</span> <span class="n">DatetimeSubtraction</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;date1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;12:34:45+3&#39;</span><span class="p">,</span> <span class="s1">&#39;23:01:02-6&#39;</span><span class="p">,</span> <span class="s1">&#39;11:59:21-8&#39;</span><span class="p">,</span> <span class="s1">&#39;08:44:23Z&#39;</span><span class="p">],</span>
    <span class="s2">&quot;date2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;09:34:45+1&#39;</span><span class="p">,</span> <span class="s1">&#39;23:01:02-6+1&#39;</span><span class="p">,</span> <span class="s1">&#39;11:59:21-8-2&#39;</span><span class="p">,</span> <span class="s1">&#39;08:44:23+3&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">dfts</span> <span class="o">=</span> <span class="n">DatetimeSubtraction</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="s2">&quot;date1&quot;</span><span class="p">,</span>
    <span class="n">reference</span><span class="o">=</span><span class="s2">&quot;date2&quot;</span><span class="p">,</span>
    <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">output_unit</span><span class="o">=</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;mixed&quot;</span>
<span class="p">)</span>

<span class="n">new</span> <span class="o">=</span> <span class="n">dfts</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
</pre></div>
</div>
<p>We see the resulting dataframe with the time difference in microseconds:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">date1</span>         <span class="n">date2</span>  <span class="n">date1_sub_date2</span>
<span class="mi">0</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">45</span><span class="o">+</span><span class="mi">3</span>    <span class="mi">09</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">45</span><span class="o">+</span><span class="mi">1</span>        <span class="mf">3600000.0</span>
<span class="mi">1</span>  <span class="mi">23</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">02</span><span class="o">-</span><span class="mi">6</span>  <span class="mi">23</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">02</span><span class="o">-</span><span class="mi">6</span><span class="o">+</span><span class="mi">1</span>       <span class="mf">25200000.0</span>
<span class="mi">2</span>  <span class="mi">11</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">21</span><span class="o">-</span><span class="mi">8</span>  <span class="mi">11</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">21</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="mi">2</span>       <span class="mf">21600000.0</span>
<span class="mi">3</span>   <span class="mi">08</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">23</span><span class="n">Z</span>    <span class="mi">08</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">23</span><span class="o">+</span><span class="mi">3</span>       <span class="mf">10800000.0</span>
</pre></div>
</div>
</section>
<section id="adding-arbitrary-names-to-the-new-variables">
<h3>Adding arbitrary names to the new variables<a class="headerlink" href="#adding-arbitrary-names-to-the-new-variables" title="Permalink to this heading">#</a></h3>
<p>Often, we want to compute just a few time differences. In this case, we may want as well
to assign the new variables specific names. In this code example, we do so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">feature_engine.datetime</span> <span class="kn">import</span> <span class="n">DatetimeSubtraction</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;date1&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2019-03-05&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">),</span>
    <span class="s2">&quot;date2&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2018-03-05&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)})</span>

<span class="n">dtf</span> <span class="o">=</span> <span class="n">DatetimeSubtraction</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="s2">&quot;date1&quot;</span><span class="p">,</span>
    <span class="n">reference</span><span class="o">=</span><span class="s2">&quot;date2&quot;</span><span class="p">,</span>
    <span class="n">new_variables_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;my_new_var&quot;</span><span class="p">]</span>
    <span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">dtf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>In the resulting dataframe, we see that the time difference was captured in a variable
called <code class="docutils literal notranslate"><span class="pre">my_new_var</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>       <span class="n">date1</span>      <span class="n">date2</span>  <span class="n">my_new_var</span>
<span class="mi">0</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">11</span>       <span class="mf">359.0</span>
<span class="mi">1</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">18</span>       <span class="mf">353.0</span>
<span class="mi">2</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">07</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">25</span>       <span class="mf">347.0</span>
<span class="mi">3</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">08</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span>       <span class="mf">341.0</span>
<span class="mi">4</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">09</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">08</span>       <span class="mf">335.0</span>
</pre></div>
</div>
<p>We should be mindful to pass a list of variales containing as many names as new variables.
The number of variables that will be created is obtained by multiplying the number of variables
in the parameter <code class="docutils literal notranslate"><span class="pre">variables</span></code> by the number of variables in the parameter <code class="docutils literal notranslate"><span class="pre">reference</span></code>.</p>
</section>
<section id="get-feature-names-out">
<h3>get_feature_names_out()<a class="headerlink" href="#get-feature-names-out" title="Permalink to this heading">#</a></h3>
<p>Finally, we can extract the names of the transformed dataframe for compatibility with the
Scikit-learn pipeline:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">feature_engine.datetime</span> <span class="kn">import</span> <span class="n">DatetimeSubtraction</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;date1&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-09-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-10-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-12-01&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date2&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-09-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-10-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-12-15&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date3&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-08-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-09-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-11-01&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date4&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-08-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-09-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-11-15&quot;</span><span class="p">],</span>
<span class="p">})</span>

<span class="n">dtf</span> <span class="o">=</span> <span class="n">DatetimeSubtraction</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">,</span> <span class="s2">&quot;date2&quot;</span><span class="p">],</span> <span class="n">reference</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date3&quot;</span><span class="p">,</span> <span class="s2">&quot;date4&quot;</span><span class="p">])</span>
<span class="n">dtf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">dtf</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
</pre></div>
</div>
<p>Below the name of the variables that will appear in any dataframe resulting from applying
the <code class="docutils literal notranslate"><span class="pre">transform()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;date1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;date2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;date3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;date4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;date1_sub_date3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;date2_sub_date3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;date1_sub_date4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;date2_sub_date4&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="combining-extraction-and-subtraction-of-datetime-features">
<h3>Combining extraction and subtraction of datetime features<a class="headerlink" href="#combining-extraction-and-subtraction-of-datetime-features" title="Permalink to this heading">#</a></h3>
<p>We can also combine the creation of numerical variables from datetime features with the
creation of new features by subtraction of datetime variables:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">feature_engine.datetime</span> <span class="kn">import</span> <span class="n">DatetimeFeatures</span><span class="p">,</span> <span class="n">DatetimeSubtraction</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;date1&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-09-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-10-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-12-01&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date2&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-09-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-10-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-12-15&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date3&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-08-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-09-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-11-01&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date4&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022-08-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-09-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-11-15&quot;</span><span class="p">],</span>
<span class="p">})</span>

<span class="n">dtf</span> <span class="o">=</span> <span class="n">DatetimeFeatures</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">,</span> <span class="s2">&quot;date2&quot;</span><span class="p">],</span> <span class="n">drop_original</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dts</span> <span class="o">=</span> <span class="n">DatetimeSubtraction</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">,</span> <span class="s2">&quot;date2&quot;</span><span class="p">],</span>
    <span class="n">reference</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date3&quot;</span><span class="p">,</span> <span class="s2">&quot;date4&quot;</span><span class="p">],</span>
    <span class="n">drop_original</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">dtf</span><span class="p">),(</span><span class="s2">&quot;subtraction&quot;</span><span class="p">,</span> <span class="n">dts</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>In the following output we see the new dataframe contaning the features that were extracted
from the different datetime variables followed by those created by capturing the time
difference:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">date1_month</span>  <span class="n">date1_year</span>  <span class="n">date1_day_of_week</span>  <span class="n">date1_day_of_month</span>  <span class="n">date1_hour</span>  \
<span class="mi">0</span>            <span class="mi">9</span>        <span class="mi">2022</span>                  <span class="mi">3</span>                   <span class="mi">1</span>           <span class="mi">0</span>
<span class="mi">1</span>           <span class="mi">10</span>        <span class="mi">2022</span>                  <span class="mi">5</span>                   <span class="mi">1</span>           <span class="mi">0</span>
<span class="mi">2</span>           <span class="mi">12</span>        <span class="mi">2022</span>                  <span class="mi">3</span>                   <span class="mi">1</span>           <span class="mi">0</span>

   <span class="n">date1_minute</span>  <span class="n">date1_second</span>  <span class="n">date2_month</span>  <span class="n">date2_year</span>  <span class="n">date2_day_of_week</span>  \
<span class="mi">0</span>             <span class="mi">0</span>             <span class="mi">0</span>            <span class="mi">9</span>        <span class="mi">2022</span>                  <span class="mi">3</span>
<span class="mi">1</span>             <span class="mi">0</span>             <span class="mi">0</span>           <span class="mi">10</span>        <span class="mi">2022</span>                  <span class="mi">5</span>
<span class="mi">2</span>             <span class="mi">0</span>             <span class="mi">0</span>           <span class="mi">12</span>        <span class="mi">2022</span>                  <span class="mi">3</span>

   <span class="n">date2_day_of_month</span>  <span class="n">date2_hour</span>  <span class="n">date2_minute</span>  <span class="n">date2_second</span>  \
<span class="mi">0</span>                  <span class="mi">15</span>           <span class="mi">0</span>             <span class="mi">0</span>             <span class="mi">0</span>
<span class="mi">1</span>                  <span class="mi">15</span>           <span class="mi">0</span>             <span class="mi">0</span>             <span class="mi">0</span>
<span class="mi">2</span>                  <span class="mi">15</span>           <span class="mi">0</span>             <span class="mi">0</span>             <span class="mi">0</span>

   <span class="n">date1_sub_date3</span>  <span class="n">date2_sub_date3</span>  <span class="n">date1_sub_date4</span>  <span class="n">date2_sub_date4</span>
<span class="mi">0</span>             <span class="mf">31.0</span>             <span class="mf">45.0</span>             <span class="mf">17.0</span>             <span class="mf">31.0</span>
<span class="mi">1</span>             <span class="mf">30.0</span>             <span class="mf">44.0</span>             <span class="mf">16.0</span>             <span class="mf">30.0</span>
<span class="mi">2</span>             <span class="mf">30.0</span>             <span class="mf">44.0</span>             <span class="mf">16.0</span>             <span class="mf">30.0</span>
</pre></div>
</div>
</section>
</section>
<section id="additional-resources">
<h2>Additional resources<a class="headerlink" href="#additional-resources" title="Permalink to this heading">#</a></h2>
<p>For tutorials on how to create and use features from datetime columns, check the following courses:</p>
<figure class="align-center align-left" id="id1">
<a class="reference external image-reference" href="https://www.trainindata.com/p/feature-engineering-for-machine-learning"><img alt="../../_images/feml.png" src="../../_images/feml.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text">Feature Engineering for Machine Learning</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center align-right" id="id2">
<a class="reference external image-reference" href="https://www.trainindata.com/p/feature-engineering-for-forecasting"><img alt="../../_images/fetsf.png" src="../../_images/fetsf.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text">Feature Engineering for Time Series Forecasting</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>Or read our book:</p>
<figure class="align-center align-left" id="id3">
<a class="reference external image-reference" href="https://www.packtpub.com/en-us/product/python-feature-engineering-cookbook-9781835883587"><img alt="../../_images/cookbook.png" src="../../_images/cookbook.png" style="width: 200px;" /></a>
<figcaption>
<p><span class="caption-text">Python Feature Engineering Cookbook</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>Both our book and course are suitable for beginners and more advanced data scientists
alike. By purchasing them you are supporting Sole, the main developer of Feature-engine.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="DatetimeFeatures.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">DatetimeFeatures</p>
      </div>
    </a>
    <a class="right-next"
       href="../selection/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Feature Selection</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subtracting-datetime-features-with-pandas">Subtracting datetime features with pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datetime-subtraction-with-feature-engine">Datetime subtraction with Feature-engine</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drop-original-variables-after-computation">Drop original variables after computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subtract-multiple-variables-simultaneously">Subtract multiple variables simultaneously</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-missing-values">Working with missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-different-timezones">Working with different timezones</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-arbitrary-names-to-the-new-variables">Adding arbitrary names to the new variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-feature-names-out">get_feature_names_out()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-extraction-and-subtraction-of-datetime-features">Combining extraction and subtraction of datetime features</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional resources</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/user_guide/datetime/DatetimeSubtraction.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>