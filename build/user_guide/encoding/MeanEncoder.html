
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MeanEncoder &#8212; 3.1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=67df843a" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=67df843a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=e1ce3931"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script defer data-domain="feature-engine.readthedocs.io" src="https://plausible.io/js/plausible.js"></script>
    <script src="../../_static/js/copybutton.js?v=84772c1c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/encoding/MeanEncoder';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Weight of Evidence (WoE)" href="WoEEncoder.html" />
    <link rel="prev" title="CountFrequencyEncoder" href="CountFrequencyEncoder.html" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

    <!-- Cookie banner -->
    <style>
        /* Style for the cookie banner */
        #cookie-banner {
            position: fixed;
            bottom: 0;
            right: 0;
            background-color: #ffe4e1; /* Light Pink */
            color: #333;
            padding: 15px;
            max-width: 400px;
            display: none;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1000; /* Set a higher z-index value */
        }

        #cookie-banner p {
        font-size: 16px; /* Font size for the text */
        color: #333 !important; /* Set link color to black */
        line-height: 1.5; /* Increase line height for added spacing between sentences */
        }

        #cookie-banner a {
            color: #333;
            text-decoration: underline;
        }
    </style>

    <div id="cookie-banner">
        <h2 style="font-size: 20px; margin-bottom: 10px;">This site uses cookies</h2>
        <p style="font-size: 16px;">We use cookies to recognize your visits and preferences, to measure the effectiveness of the documentation, and discover how people find us. With your consent, you're helping us make our documentation better. <br><a href="https://www.trainindata.com/p/privacy" target="_blank">Learn More</a>.</p>
        <button id="cookie-accept">Accept</button>
        <button id="cookie-decline">Decline</button>
    </div>

    <script>
        // JavaScript to show the cookie banner and handle the accept button
        document.addEventListener('DOMContentLoaded', function () {
            var cookieBanner = document.getElementById('cookie-banner');
            var acceptButton = document.getElementById('cookie-accept');
            var declineButton = document.getElementById('cookie-decline');

            // Check if the user has already accepted or declined cookies
            var cookiesAccepted = localStorage.getItem('cookiesAccepted');

            if (!cookiesAccepted) {
                cookieBanner.style.display = 'block';

                acceptButton.addEventListener('click', function () {
                    localStorage.setItem('cookiesAccepted', 'true');
                    loadGoogleAnalytics();
                    cookieBanner.style.display = 'none';
                });

                declineButton.addEventListener('click', function () {
                    localStorage.setItem('cookiesAccepted', 'false');
                    cookieBanner.style.display = 'none';
                });
            } else if (cookiesAccepted === 'true') {
                loadGoogleAnalytics();
            }
        });

        function loadGoogleAnalytics() {
            // Load Google Analytics only if consent is given
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-Z6MPCG673G';
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-Z6MPCG673G');
        }
    </script>
    <!-- Cookie banner -->


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/sageops_logo.png" class="logo__image only-light" alt="3.1 - Home"/>
    <script>document.write(`<img src="../../_static/sageops_logo.png" class="logo__image only-dark" alt="3.1 - Home"/>`);</script>
  
  
</a></div>
    
      <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../quickstart/index.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        SageOps User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api_doc/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../example_notebooks/index.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../about/index.html">
                        About
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../quickstart/index.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        SageOps User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api_doc/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../example_notebooks/index.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../about/index.html">
                        About
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../imputation/index.html">Experiment</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../imputation/MeanMedianImputer.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/ArbitraryNumberImputer.html">Experiment Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/EndTailImputer.html">EndTailImputer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/CategoricalImputer.html">CategoricalImputer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/RandomSampleImputer.html">RandomSampleImputer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/AddMissingIndicator.html">AddMissingIndicator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imputation/DropMissingData.html">DropMissingData</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Categorical Encoding</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="OneHotEncoder.html">OneHotEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="OrdinalEncoder.html">Ordinal Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="CountFrequencyEncoder.html">CountFrequencyEncoder</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">MeanEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="WoEEncoder.html">Weight of Evidence (WoE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="DecisionTreeEncoder.html">DecisionTreeEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="RareLabelEncoder.html">RareLabelEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="StringSimilarityEncoder.html">StringSimilarityEncoder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../discretisation/index.html">Discretisation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../discretisation/EqualFrequencyDiscretiser.html">EqualFrequencyDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discretisation/EqualWidthDiscretiser.html">EqualWidthDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discretisation/ArbitraryDiscretiser.html">ArbitraryDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discretisation/DecisionTreeDiscretiser.html">DecisionTreeDiscretiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discretisation/GeometricWidthDiscretiser.html">GeometricWidthDiscretiser</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../outliers/index.html">Outlier Handling</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../outliers/Winsorizer.html">Winsorizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outliers/ArbitraryOutlierCapper.html">ArbitraryOutlierCapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outliers/OutlierTrimmer.html">OutlierTrimmer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../transformation/index.html">Variance Stabilizing Transformations</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../transformation/LogTransformer.html">LogTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/LogCpTransformer.html">LogCpTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/ReciprocalTransformer.html">ReciprocalTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/ArcsinTransformer.html">ArcsinTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/PowerTransformer.html">PowerTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/BoxCoxTransformer.html">BoxCoxTransformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformation/YeoJohnsonTransformer.html">YeoJohnsonTransformer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../scaling/index.html">Scaling</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../scaling/MeanNormalizationScaler.html">MeanNormalizationScaler</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../creation/index.html">Feature Creation</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../creation/CyclicalFeatures.html">CyclicalFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../creation/MathFeatures.html">MathFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../creation/RelativeFeatures.html">RelativeFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../creation/DecisionTreeFeatures.html">DecisionTreeFeatures</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../datetime/index.html">Datetime Features</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../datetime/DatetimeFeatures.html">DatetimeFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datetime/DatetimeSubtraction.html">DatetimeSubtraction</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../selection/index.html">Feature Selection</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../selection/DropFeatures.html">DropFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/DropConstantFeatures.html">DropConstantFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/DropDuplicateFeatures.html">DropDuplicateFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/DropCorrelatedFeatures.html">DropCorrelatedFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/SmartCorrelatedSelection.html">SmartCorrelatedSelection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/SelectBySingleFeaturePerformance.html">SelectBySingleFeaturePerformance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/RecursiveFeatureElimination.html">RecursiveFeatureElimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/RecursiveFeatureAddition.html">RecursiveFeatureAddition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/SelectByShuffling.html">SelectByShuffling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/SelectByTargetMeanPerformance.html">SelectByTargetMeanPerformance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/DropHighPSIFeatures.html">DropHighPSIFeatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/SelectByInformationValue.html">SelectByInformationValue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/ProbeFeatureSelection.html">ProbeFeatureSelection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selection/MRMR.html">MRMR - Minimum Redundancy Maximum Relevance</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../timeseries/index.html">Time Series Features</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../timeseries/forecasting/index.html">Forecasting Features</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../preprocessing/index.html">Preprocessing</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/MatchCategories.html">MatchCategories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/MatchVariables.html">MatchVariables</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../wrappers/index.html">Scikit-learn Wrapper</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../wrappers/Wrapper.html">SklearnTransformerWrapper</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../pipeline/index.html">Pipeline</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/Pipeline.html">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/make_pipeline.html">make_pipeline</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../variable_handling/index.html">Variable handling functions</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/find_all_variables.html">find_all_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/find_categorical_variables.html">find_categorical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/find_datetime_variables.html">find_datetime_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/find_numerical_variables.html">find_numerical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/find_categorical_and_numerical_variables.html">find_categorical_and_numerical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/check_all_variables.html">check_all_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/check_categorical_variables.html">check_categorical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/check_datetime_variables.html">check_datetime_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/check_numerical_variables.html">check_numerical_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variable_handling/retain_variables_if_in_df.html">retain_variables_if_in_df</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">SageOps User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Categorical Encoding</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">MeanEncoder</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="meanencoder">
<span id="mean-encoder"></span><h1>MeanEncoder<a class="headerlink" href="#meanencoder" title="Permalink to this heading">#</a></h1>
<p>Mean encoding is the process of replacing the categories in categorical features by the
mean value of the target variable shown by each category. For example, if we are trying
to predict the default rate (that’s the target variable), and our dataset has the categorical
variable <strong>City</strong>, with the categories of <strong>London</strong>, <strong>Manchester</strong>, and <strong>Bristol</strong>,
and the default rate per city is 0.1, 0.5, and 0.3, respectively, with mean encoding, we
would replace London by 0.1, Manchester by 0.5, and Bristol by 0.3.</p>
<p>Mean encoding, together with one hot encoding and ordinal encoding, belongs to the most
commonly used categorical encoding techniques in data science.</p>
<p>It is said that mean encoding can easily cause overfitting. That’s because we are capturing
some information about the target into the predictive features during the encoding. More
importantly, the overfitting can be caused by encoding categories with low frequencies
with mean target values that are unreliable. In short, the mean target values seen for
those categories in the training set do not hold for test data or new observations.</p>
<section id="overfitting">
<h2>Overfitting<a class="headerlink" href="#overfitting" title="Permalink to this heading">#</a></h2>
<p>When the categories in the categorical features have a good representation, or, in other
words, when there are enough observations in our dataset that show the categories that we
want to encode, then taking the simple average of the target variable per category is a
good approximation. We can trust that a new data point, say from the test data, that
shows that category will also have a target value that is similar to the target mean
value that we calculated for said category during training.</p>
<p>However, if there are only a few observations that show some of the categories, then the
mean target value for those categories will be unreliable. In other words, the certainty
that we have that a new observation that shows this category will have a mean target value
close to the one we estimated decreases.</p>
<p>To account for the uncertainty of the encoding values for rare categories, what we normally
do is <strong>“blend”</strong> the mean target variable per category with the general mean of the target,
calculated over the entire training dataset. And this blending is proportional to the
variability of the target within that category and the category frequency.</p>
</section>
<section id="smoothing">
<h2>Smoothing<a class="headerlink" href="#smoothing" title="Permalink to this heading">#</a></h2>
<p>To avoid overfitting, we can determine the mean target value estimates as a mixture of two
values: the mean target value per category (known as the posterior) and the mean target
value in the entire dataset (known as the prior).</p>
<p>The following formula shows the estimation of the mean target value with smoothing:</p>
<div class="math notranslate nohighlight">
\[mapping = (w_i) posterior + (1-w_i) prior\]</div>
<p>The prior and posterior values are “blended” using a weighting factor (<code class="docutils literal notranslate"><span class="pre">wi</span></code>). This weighting
factor is a function of the category group size (<code class="docutils literal notranslate"><span class="pre">n_i</span></code>) and the variance of the target in
the data (<code class="docutils literal notranslate"><span class="pre">t</span></code>) and within the category (<code class="docutils literal notranslate"><span class="pre">s</span></code>):</p>
<div class="math notranslate nohighlight">
\[w_i = n_i t / (s + n_i t)\]</div>
<p>When the category group is large, the weighing factor is close to 1, and therefore more
weight is given to the posterior (the mean of the target per category). When the category
group size is small, then the weight gets closer to 0, and more weight is given to the
prior (the mean of the target in the entire dataset).</p>
<p>In addition, if the variability of the target within that category is large, we also give
more weight to the prior, whereas if it is small, then we give more weight to the posterior.</p>
<p>In short, adding smoothing can help prevent overfitting in those cases where categorical
data have many infrequent categories or show high cardinality.</p>
</section>
<section id="high-cardinality">
<h2>High cardinality<a class="headerlink" href="#high-cardinality" title="Permalink to this heading">#</a></h2>
<p>High cardinality refers to a high number of unique categories in the categorical features.
Mean encoding was specifically designed to tackle highly cardinal variables by taking
advantage of this smoothing function, which will essentially blend infrequent categories
together by replacing them with values very close to the overall target mean calculated
over the training data.</p>
<p>Another encoding method that tackles cardinality out of the box is count encoding. See for
example <code class="xref py py-class docutils literal notranslate"><span class="pre">CountFrequencyEncoder</span></code>.</p>
<p>To account for highly cardinal variables in alternative encoding methods, you can group
rare categories together by using the <code class="xref py py-class docutils literal notranslate"><span class="pre">RareLabelEncoder</span></code>.</p>
</section>
<section id="alternative-python-implementations-of-mean-encoding">
<h2>Alternative Python implementations of mean encoding<a class="headerlink" href="#alternative-python-implementations-of-mean-encoding" title="Permalink to this heading">#</a></h2>
<p>In Feature-engine, we blend the probabilities considering the target variability and the
category frequency. In the original paper, there are alternative formulations to determine
the blending. If you want to check those out, use the transformers from the Python library
Category encoders:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://contrib.scikit-learn.org/category_encoders/mestimate.html">M-estimate</a></p></li>
<li><p><a class="reference external" href="https://contrib.scikit-learn.org/category_encoders/targetencoder.html">Target Encoder</a></p></li>
</ul>
</section>
<section id="id1">
<h2>Mean encoder<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>Feature-engine’s <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanEncoder()</span></code> replaces categories with the mean of the target per
category. By default, it does not implement smoothing. That means that it will replace
categories by the mean target value as determined during training over the training data
set (just the posterior).</p>
<p>To apply smoothing using the formulation that we described earlier, set the parameter
<code class="docutils literal notranslate"><span class="pre">smoothing</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code>. That would be our recommended solution. Alternatively, you can
set the parameter <code class="docutils literal notranslate"><span class="pre">smoothing</span></code> to any value that you want, in which case the weighting
factor <code class="docutils literal notranslate"><span class="pre">wi</span></code> will be calculated like this:</p>
<div class="math notranslate nohighlight">
\[w_i = n_i / (s + n_i)\]</div>
<p>where s is the value your pass to <code class="docutils literal notranslate"><span class="pre">smoothing</span></code>.</p>
</section>
<section id="unseen-categories">
<h2>Unseen categories<a class="headerlink" href="#unseen-categories" title="Permalink to this heading">#</a></h2>
<p>Unseen categories are those labels that were not seen during training. Or in other words,
categories that were not present in the training data.</p>
<p>With the <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanEncoder()</span></code>, we can take care of unseen categories in 1 of 3 ways:</p>
<ul class="simple">
<li><p>We can set the mean encoder to ignore unseen categories, in which case those categories will be replaced by nan.</p></li>
<li><p>We can set the mean encoder to raise an error when it encounters unseen categories. This is useful when we don’t expect new categories for those categorical variables.</p></li>
<li><p>We can instruct the mean encoder to replace unseen or new categories with the mean of the target shown in the training data, that is, the prior.</p></li>
</ul>
</section>
<section id="mean-encoding-and-machine-learning">
<h2>Mean encoding and machine learning<a class="headerlink" href="#mean-encoding-and-machine-learning" title="Permalink to this heading">#</a></h2>
<p>Feature-engine’s <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanEncoder()</span></code> can perform mean encoding for regression and binary
classification datasets. At the moment, we do not support multi-class targets.</p>
</section>
<section id="python-examples">
<h2>Python examples<a class="headerlink" href="#python-examples" title="Permalink to this heading">#</a></h2>
<p>In the following sections, we’ll show the functionality of <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanEncoder()</span></code> using the
Titanic Dataset.</p>
<p>First, let’s load the libraries, functions and classes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">feature_engine.datasets</span> <span class="kn">import</span> <span class="n">load_titanic</span>
<span class="kn">from</span> <span class="nn">feature_engine.encoding</span> <span class="kn">import</span> <span class="n">MeanEncoder</span>
</pre></div>
</div>
<p>To avoid data leakage, it is important to separate the data into training and test sets.
The mean target values, with or without smoothing, will be determined using the training
data only.</p>
<p>Let’s load and split the data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_titanic</span><span class="p">(</span>
    <span class="n">return_X_y_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">handle_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">predictors_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cabin</span><span class="o">=</span><span class="s2">&quot;letter_only&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<p>We see the resulting dataframe containing 3 categorical columns: sex, cabin and embarked:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>      <span class="n">pclass</span>     <span class="n">sex</span>        <span class="n">age</span>  <span class="n">sibsp</span>  <span class="n">parch</span>     <span class="n">fare</span> <span class="n">cabin</span> <span class="n">embarked</span>
<span class="mi">501</span>        <span class="mi">2</span>  <span class="n">female</span>  <span class="mf">13.000000</span>      <span class="mi">0</span>      <span class="mi">1</span>  <span class="mf">19.5000</span>     <span class="n">M</span>        <span class="n">S</span>
<span class="mi">588</span>        <span class="mi">2</span>  <span class="n">female</span>   <span class="mf">4.000000</span>      <span class="mi">1</span>      <span class="mi">1</span>  <span class="mf">23.0000</span>     <span class="n">M</span>        <span class="n">S</span>
<span class="mi">402</span>        <span class="mi">2</span>  <span class="n">female</span>  <span class="mf">30.000000</span>      <span class="mi">1</span>      <span class="mi">0</span>  <span class="mf">13.8583</span>     <span class="n">M</span>        <span class="n">C</span>
<span class="mi">1193</span>       <span class="mi">3</span>    <span class="n">male</span>  <span class="mf">29.881135</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mf">7.7250</span>     <span class="n">M</span>        <span class="n">Q</span>
<span class="mi">686</span>        <span class="mi">3</span>  <span class="n">female</span>  <span class="mf">22.000000</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mf">7.7250</span>     <span class="n">M</span>        <span class="n">Q</span>
</pre></div>
</div>
</section>
<section id="simple-mean-encoding">
<h2>Simple mean encoding<a class="headerlink" href="#simple-mean-encoding" title="Permalink to this heading">#</a></h2>
<p>Let’s set up the <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanEncoder()</span></code> to replace the categories in the categorical
features with the target mean, without smoothing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">MeanEncoder</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cabin&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;embarked&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">fit()</span></code> the encoder learns the target mean value for each category and stores those
values in the <code class="docutils literal notranslate"><span class="pre">encoder_dict_</span></code> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">encoder</span><span class="o">.</span><span class="n">encoder_dict_</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">encoder_dict_</span></code> contains the mean value of the target per category, per variable.
We can use this dictionary to map the numbers in the encoded features to the original
categorical values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;cabin&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">0.5294117647058824</span><span class="p">,</span>
  <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">0.7619047619047619</span><span class="p">,</span>
  <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.5633802816901409</span><span class="p">,</span>
  <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mf">0.71875</span><span class="p">,</span>
  <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mf">0.71875</span><span class="p">,</span>
  <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">,</span>
  <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
  <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mf">0.30484330484330485</span><span class="p">,</span>
  <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
 <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;female&#39;</span><span class="p">:</span> <span class="mf">0.7283582089552239</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">:</span> <span class="mf">0.18760757314974183</span><span class="p">},</span>
 <span class="s1">&#39;embarked&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.553072625698324</span><span class="p">,</span>
  <span class="s1">&#39;Missing&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
  <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="mf">0.37349397590361444</span><span class="p">,</span>
  <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mf">0.3389570552147239</span><span class="p">}}</span>
</pre></div>
</div>
<p>We can now go ahead and replace the categorical values with the numerical values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_t</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">test_t</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">train_t</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<p>Below we see the resulting dataframe, where the categorical values are now replaced
with the target mean values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>      <span class="n">pclass</span>       <span class="n">sex</span>        <span class="n">age</span>  <span class="n">sibsp</span>  <span class="n">parch</span>     <span class="n">fare</span>     <span class="n">cabin</span>  <span class="n">embarked</span>
<span class="mi">501</span>        <span class="mi">2</span>  <span class="mf">0.728358</span>  <span class="mf">13.000000</span>      <span class="mi">0</span>      <span class="mi">1</span>  <span class="mf">19.5000</span>  <span class="mf">0.304843</span>  <span class="mf">0.338957</span>
<span class="mi">588</span>        <span class="mi">2</span>  <span class="mf">0.728358</span>   <span class="mf">4.000000</span>      <span class="mi">1</span>      <span class="mi">1</span>  <span class="mf">23.0000</span>  <span class="mf">0.304843</span>  <span class="mf">0.338957</span>
<span class="mi">402</span>        <span class="mi">2</span>  <span class="mf">0.728358</span>  <span class="mf">30.000000</span>      <span class="mi">1</span>      <span class="mi">0</span>  <span class="mf">13.8583</span>  <span class="mf">0.304843</span>  <span class="mf">0.553073</span>
<span class="mi">1193</span>       <span class="mi">3</span>  <span class="mf">0.187608</span>  <span class="mf">29.881135</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mf">7.7250</span>  <span class="mf">0.304843</span>  <span class="mf">0.373494</span>
<span class="mi">686</span>        <span class="mi">3</span>  <span class="mf">0.728358</span>  <span class="mf">22.000000</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mf">7.7250</span>  <span class="mf">0.304843</span>  <span class="mf">0.373494</span>
</pre></div>
</div>
</section>
<section id="mean-encoding-with-smoothing">
<h2>Mean encoding with smoothing<a class="headerlink" href="#mean-encoding-with-smoothing" title="Permalink to this heading">#</a></h2>
<p>By default, <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanEncoder()</span></code> determines the mean target values without blending.
If we want to apply smoothing to control the cardinality of the variable and avoid
overfitting, we set up the transformer as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">MeanEncoder</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">smoothing</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span>
<span class="p">)</span>

<span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, we did not indicate which variables to encode. <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanEncoder()</span></code> can
automatically find the categorical variables, which are stored in one of its attributes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">encoder</span><span class="o">.</span><span class="n">variables_</span>
</pre></div>
</div>
<p>Below we see the categorical features found by <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanEncoder()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;cabin&#39;</span><span class="p">,</span> <span class="s1">&#39;embarked&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>We can find the categorical mappings calculated by the mean encoder:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">encoder</span><span class="o">.</span><span class="n">encoder_dict_</span>
</pre></div>
</div>
<p>Note that these values are different to those determined without smoothing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;female&#39;</span><span class="p">:</span> <span class="mf">0.7275051072923914</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">:</span> <span class="mf">0.18782635616273297</span><span class="p">},</span>
 <span class="s1">&#39;cabin&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">0.5210189753697639</span><span class="p">,</span>
  <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">0.755161569137655</span><span class="p">,</span>
  <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.5608140829162441</span><span class="p">,</span>
  <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mf">0.7100896537503179</span><span class="p">,</span>
  <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mf">0.7100896537503179</span><span class="p">,</span>
  <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">0.6501082490288561</span><span class="p">,</span>
  <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mf">0.47606795923242295</span><span class="p">,</span>
  <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mf">0.3049458046855866</span><span class="p">,</span>
  <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
 <span class="s1">&#39;embarked&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.552100581239763</span><span class="p">,</span>
  <span class="s1">&#39;Missing&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
  <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="mf">0.3736336816011083</span><span class="p">,</span>
  <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mf">0.3390242994568531</span><span class="p">}}</span>
</pre></div>
</div>
<p>We can now go ahead and replace the categorical values with the numerical values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_t</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">test_t</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">train_t</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<p>Below we see the resulting dataframe with the encoded features:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>      <span class="n">pclass</span>       <span class="n">sex</span>        <span class="n">age</span>  <span class="n">sibsp</span>  <span class="n">parch</span>     <span class="n">fare</span>     <span class="n">cabin</span>  <span class="n">embarked</span>
<span class="mi">501</span>        <span class="mi">2</span>  <span class="mf">0.727505</span>  <span class="mf">13.000000</span>      <span class="mi">0</span>      <span class="mi">1</span>  <span class="mf">19.5000</span>  <span class="mf">0.304946</span>  <span class="mf">0.339024</span>
<span class="mi">588</span>        <span class="mi">2</span>  <span class="mf">0.727505</span>   <span class="mf">4.000000</span>      <span class="mi">1</span>      <span class="mi">1</span>  <span class="mf">23.0000</span>  <span class="mf">0.304946</span>  <span class="mf">0.339024</span>
<span class="mi">402</span>        <span class="mi">2</span>  <span class="mf">0.727505</span>  <span class="mf">30.000000</span>      <span class="mi">1</span>      <span class="mi">0</span>  <span class="mf">13.8583</span>  <span class="mf">0.304946</span>  <span class="mf">0.552101</span>
<span class="mi">1193</span>       <span class="mi">3</span>  <span class="mf">0.187826</span>  <span class="mf">29.881135</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mf">7.7250</span>  <span class="mf">0.304946</span>  <span class="mf">0.373634</span>
<span class="mi">686</span>        <span class="mi">3</span>  <span class="mf">0.727505</span>  <span class="mf">22.000000</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mf">7.7250</span>  <span class="mf">0.304946</span>  <span class="mf">0.373634</span>
</pre></div>
</div>
<p>We can now use this dataframes to train machine learning models for regression or
classification.</p>
</section>
<section id="mean-encoding-variables-with-numerical-values">
<h2>Mean encoding variables with numerical values<a class="headerlink" href="#mean-encoding-variables-with-numerical-values" title="Permalink to this heading">#</a></h2>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">MeanEncoder()</span></code>, and all Feature-engine encoders, have been designed to work with
variables of type object or categorical by default. If you want to encode variables that
are numeric, you need to instruct the transformer to ignore the data type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">MeanEncoder</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cabin&#39;</span><span class="p">,</span> <span class="s1">&#39;pclass&#39;</span><span class="p">],</span>
    <span class="n">ignore_format</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">t_train</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">t_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
<p>After encoding the features we can use the data sets to train machine learning algorithms.</p>
<p>Last thing to note before closing in is that mean encoding does not increase the
dimensionality of the resulting dataframes: from 1 categorical feature, we obtain 1
encoded variable. Hence, this encoding method is suitable for predictive modeling that
uses models that are sensitive to the size of the feature space.</p>
</section>
<section id="additional-resources">
<h2>Additional resources<a class="headerlink" href="#additional-resources" title="Permalink to this heading">#</a></h2>
<p>In the following notebook, you can find more details into the <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanEncoder()</span></code>
functionality and example plots with the encoded variables:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://nbviewer.org/github/feature-engine/feature-engine-examples/blob/main/encoding/MeanEncoder.ipynb">Jupyter notebook</a></p></li>
</ul>
<p>For tutorials about this and other feature engineering methods check out these resources:</p>
<figure class="align-center align-left" id="id2">
<a class="reference external image-reference" href="https://www.trainindata.com/p/feature-engineering-for-machine-learning"><img alt="../../_images/feml.png" src="../../_images/feml.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text">Feature Engineering for Machine Learning</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center align-right" id="id3">
<a class="reference external image-reference" href="https://www.trainindata.com/p/feature-engineering-for-forecasting"><img alt="../../_images/fetsf.png" src="../../_images/fetsf.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text">Feature Engineering for Time Series Forecasting</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>Or read our book:</p>
<figure class="align-center align-left" id="id4">
<a class="reference external image-reference" href="https://www.packtpub.com/en-us/product/python-feature-engineering-cookbook-9781835883587"><img alt="../../_images/cookbook.png" src="../../_images/cookbook.png" style="width: 200px;" /></a>
<figcaption>
<p><span class="caption-text">Python Feature Engineering Cookbook</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>Both our book and courses are suitable for beginners and more advanced data scientists
alike. By purchasing them you are supporting Sole, the main developer of Feature-engine.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="CountFrequencyEncoder.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">CountFrequencyEncoder</p>
      </div>
    </a>
    <a class="right-next"
       href="WoEEncoder.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Weight of Evidence (WoE)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overfitting">Overfitting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smoothing">Smoothing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#high-cardinality">High cardinality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-python-implementations-of-mean-encoding">Alternative Python implementations of mean encoding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Mean encoder</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unseen-categories">Unseen categories</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-encoding-and-machine-learning">Mean encoding and machine learning</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-examples">Python examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-mean-encoding">Simple mean encoding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-encoding-with-smoothing">Mean encoding with smoothing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-encoding-variables-with-numerical-values">Mean encoding variables with numerical values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional resources</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/user_guide/encoding/MeanEncoder.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>